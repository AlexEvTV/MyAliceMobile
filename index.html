<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ú–æ—è –ê–ª–∏—Å–∞</title>
    <style>
        * {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: #f0f0f0;
            height: 100vh;
            font-family: Arial, sans-serif;
            touch-action: manipulation;
        }
        
        .phone {
            width: calc(100vh * (9/16));
            height: 100vh;
            max-width: 100%;
            margin: 0 auto;
            position: relative;
            overflow: hidden;
        }
        
        .room {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            display: none;
            background-size: cover;
            background-position: center;
        }
        
        #smileBg {
            background-image: url('SmileBg.png');
            display: block;
        }
        
        #foodBg {
            background-image: url('FoodBg.png');
        }
        
        #toiletBg {
            background-image: url('ToiletBg.png');
        }
        
        #sleepBg {
            background-image: url('SleepBg.png');
        }
        
        .level-container {
            position: absolute;
            top: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 10;
        }
        
        .level-display {
            width: 12vh;
            height: 12vh;
            background: #ccc;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 4vh;
            font-weight: bold;
            box-shadow: 0 0 2vh rgba(0,0,0,0.3);
            position: relative;
        }
        
        .level-progress {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(#4CAF50 0%, #4CAF50 var(--progress), rgba(0,0,0,0.1) var(--progress), rgba(0,0,0,0.1) 100%);
            transform: rotate(-90deg);
            z-index: 1;
        }
        
        .level-number {
            position: relative;
            z-index: 2;
            width: 10vh;
            height: 10vh;
            background: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: inset 0 0 1vh rgba(0,0,0,0.2);
        }
        
        .buttons-container {
            display: flex;
            gap: 1vh;
            margin-top: 1vh;
            flex-wrap: wrap;
            justify-content: center;
            width: 12vh;
        }
        
        .settings-btn {
            font-size: 2.5vh;
            cursor: pointer;
            transition: transform 0.2s;
            width: 5vh;
            height: 5vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 50%;
            box-shadow: 0 0 1vh rgba(0,0,0,0.2);
        }
        
        .settings-btn:active {
            transform: scale(0.8);
        }
        
        .click-counter {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.8);
            padding: 1vh 2vh;
            border-radius: 2vh;
            font-size: 3vh;
            box-shadow: 0 0 1vh rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            z-index: 10;
        }
        
        .click-counter::after {
            content: "üëÜ";
            margin-left: 0.5vh;
        }
        
        .crystal-counter {
            position: absolute;
            top: 70px;
            right: 20px;
            background: rgba(255,255,255,0.8);
            padding: 1vh 2vh;
            border-radius: 2vh;
            font-size: 3vh;
            box-shadow: 0 0 1vh rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            z-index: 10;
        }
        
        .alice-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 25vh;
            height: 25vh;
            cursor: pointer;
            z-index: 5;
        }
        
        .alice {
            width: 100%;
            height: 100%;
            object-fit: contain;
            transition: transform 0.1s ease;
        }
        
        .buttons {
            display: flex;
            justify-content: space-around;
            width: 100%;
            padding: 2vh 0;
            position: absolute;
            bottom: 0;
            background: rgba(0,0,0,0.2);
            z-index: 10;
        }
        
        .btn {
            width: 8vh;
            height: 8vh;
            border-radius: 50%;
            background: #FF4500;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 3.5vh;
            cursor: pointer;
            margin: 0 1vh;
            box-shadow: 0 0.4vh 1vh rgba(0,0,0,0.2);
            transition: transform 0.2s, background 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .btn-progress {
            position: absolute;
            width: 100%;
            bottom: 0;
            left: 0;
            background: #4CAF50;
            transition: height 0.3s ease;
            z-index: 1;
        }
        
        .btn-content {
            position: relative;
            z-index: 2;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
        }
        
        .btn.completed .btn-content {
            background: #4CAF50;
        }
        
        .btn:active {
            transform: scale(0.9);
        }
        
        .light-switch {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 8vh;
            height: 8vh;
            background: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3.5vh;
            cursor: pointer;
            box-shadow: 0 0 2vh rgba(0,0,0,0.3);
            z-index: 15;
            display: none;
            transition: transform 0.2s;
        }
        
        .light-switch:active {
            transform: scale(0.9);
        }
        
        .dark-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 5;
            display: none;
        }
        
        .sleep-timer {
            position: absolute;
            top: 20px;
            right: 100px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 1vh 2vh;
            border-radius: 2vh;
            font-size: 3vh;
            z-index: 15;
            display: none;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .modal-overlay.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .modal {
            background: white;
            padding: 3vh;
            border-radius: 2vh;
            width: 70%;
            max-width: 300px;
            text-align: center;
            transform: scale(0.9);
            transition: transform 0.3s;
        }
        
        .modal-overlay.active .modal {
            transform: scale(1);
        }
        
        .modal-title {
            font-size: 3vh;
            margin-bottom: 2vh;
        }
        
        .modal-buttons {
            display: flex;
            justify-content: space-around;
            margin-top: 3vh;
        }
        
        .modal-btn {
            padding: 1vh 2vh;
            border-radius: 1vh;
            font-size: 2.5vh;
            cursor: pointer;
            transition: all 0.2s;
            min-width: 6vh;
            text-align: center;
        }
        
        .modal-btn-yes {
            background: #ccc;
            color: black;
        }
        
        .modal-btn-no {
            background: #FF4500;
            color: white;
        }
        
        .modal-btn:active {
            opacity: 0.8;
            transform: scale(0.95);
        }
        
        .settings-modal {
            width: 80%;
            max-width: 350px;
        }
        
        .settings-option {
            padding: 2vh;
            margin: 1vh 0;
            background: #f5f5f5;
            border-radius: 1vh;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .settings-option:active {
            background: #e0e0e0;
        }
        
        .manual-image {
            width: 100%;
            max-height: 60vh;
            object-fit: contain;
            margin: 2vh 0;
        }
        
        .back-btn {
            padding: 1.5vh;
            background: #FF4500;
            color: white;
            border-radius: 1vh;
            margin-top: 2vh;
            cursor: pointer;
            width: 100%;
            box-sizing: border-box;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .manual-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2vh;
        }
        
        .manual-btn {
            padding: 1vh 2vh;
            border-radius: 1vh;
            font-size: 2vh;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            justify-content: center;
            align-items: center;
            min-width: 8vh;
        }
        
        .manual-btn-prev {
            background: #ccc;
            color: black;
        }
        
        .manual-btn-next {
            background: #4CAF50;
            color: white;
        }
        
        .manual-btn-done {
            background: #4CAF50;
            color: white;
            display: none;
        }
        
        @keyframes aliceClick {
            0% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(0.98) translateY(5px); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }
        
        .click-animation {
            animation: aliceClick 0.2s ease;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –µ–¥—ã */
        .food-items {
            position: absolute;
            bottom: 12vh;
            width: 100%;
            display: flex;
            justify-content: space-around;
            z-index: 5;
        }
        
        .food-item {
            width: 8vh;
            height: 8vh;
            font-size: 5vh;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: grab;
            user-select: none;
            position: relative;
            transition: transform 0.2s;
        }
        
        .food-item:active {
            cursor: grabbing;
        }
        
        .food-item.dragging {
            position: absolute;
            z-index: 100;
            transform: scale(1.2);
            pointer-events: none;
        }
        
        @keyframes eatAnimation {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0); opacity: 0; }
        }
        
        .eating {
            animation: eatAnimation 0.3s forwards;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç—É–∞–ª–µ—Ç–Ω–æ–π –¥–≤–µ—Ä–∏ */
        .toilet-door {
            position: absolute;
            width: 15vh;
            height: 25vh;
            right: 10%;
            top: 50%;
            transform: translateY(-50%);
            background-color: #d3d3d3;
            border: 2px solid #999;
            border-radius: 1vh;
            cursor: grab;
            z-index: 6;
            transition: transform 0.3s ease;
            touch-action: none;
        }
        
        .toilet-door:active {
            cursor: grabbing;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∫–æ—Å—Ç—é–º–æ–≤ */
        .costumes-modal {
            width: 90%;
            max-width: 400px;
            height: 70vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .costumes-container {
            flex-grow: 1;
            overflow-y: auto;
            padding: 1vh;
        }
        
        .costume-category {
            margin-bottom: 2vh;
        }
        
        .costume-category-title {
            font-size: 2.5vh;
            margin-bottom: 1vh;
            color: #555;
        }
        
        .costume-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5vh;
        }
        
        .costume-item {
            background: #f5f5f5;
            border-radius: 1vh;
            padding: 1.5vh;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .costume-item:active {
            transform: scale(0.95);
        }
        
        .costume-item.locked {
            opacity: 0.6;
            position: relative;
        }
        
        .costume-item.locked::after {
            content: "üîí";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3vh;
        }
        
        .costume-image {
            width: 100%;
            height: 10vh;
            object-fit: contain;
            margin-bottom: 1vh;
        }
        
        .costume-name {
            font-size: 2vh;
            font-weight: bold;
            margin-bottom: 0.5vh;
        }
        
        .costume-info {
            font-size: 1.8vh;
            color: #777;
        }
        
        .costume-price {
            font-size: 1.8vh;
            margin-top: 0.5vh;
            color: #4CAF50;
        }
        
        .costume-price.locked {
            color: #FF4500;
        }
        
        .costume-scrollbar {
            height: 0.5vh;
            background: #eee;
            border-radius: 0.5vh;
            margin-top: 1vh;
            position: relative;
        }
        
        .costume-scrollbar-thumb {
            position: absolute;
            height: 100%;
            background: #FF4500;
            border-radius: 0.5vh;
            width: 30%;
            left: 0;
        }
        
        .selected-costume {
            border: 2px solid #4CAF50;
            background: #e8f5e9;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –º–∞–≥–∞–∑–∏–Ω–∞ */
        .shop-modal {
            width: 90%;
            max-width: 400px;
            height: 70vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .shop-container {
            flex-grow: 1;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 1vh;
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 0;
            scroll-snap-type: x mandatory;
            scroll-behavior: smooth;
        }
        
        .shop-category {
            margin-bottom: 0;
            scroll-snap-align: start;
            min-width: 100%;
        }
        
        .shop-category-title {
            font-size: 2.5vh;
            margin-bottom: 1vh;
            color: #555;
        }
        
        .shop-items {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0;
        }
        
        .shop-item {
            background: transparent;
            border-radius: 1vh;
            padding: 0;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
            height: 20vh;
            width: 100%;
            margin: 0;
        }
        
        .shop-item:active {
            transform: scale(0.95);
        }
        
        .shop-item.locked {
            opacity: 0.6;
            position: relative;
        }
        
        .shop-item.locked::after {
            content: "üîí";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3vh;
        }
        
        .shop-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .shop-name {
            font-size: 2.5vh;
            font-weight: bold;
            margin-bottom: 0.5vh;
            display: none;
        }
        
        .shop-description {
            font-size: 1.8vh;
            color: #777;
            margin-bottom: 1vh;
            display: none;
        }
        
        .shop-price {
            font-size: 2vh;
            margin-top: 0.5vh;
            color: #4CAF50;
            font-weight: bold;
            display: none;
        }
        
        .shop-price.locked {
            color: #FF4500;
        }
        
        .shop-scrollbar {
            height: 0.5vh;
            background: #eee;
            border-radius: 0.5vh;
            margin-top: 1vh;
            position: relative;
        }
        
        .shop-scrollbar-thumb {
            position: absolute;
            height: 100%;
            background: #FF4500;
            border-radius: 0.5vh;
            width: 30%;
            left: 0;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤–≤–æ–¥–∞ –ø—Ä–æ–º–æ–∫–æ–¥–∞ */
        .promo-section {
            margin-top: 2vh;
            padding-top: 2vh;
            border-top: 1px solid #eee;
            max-width: 100%;
            overflow: hidden;
            display: flex;
            align-items: center;
            gap: 1vh;
        }
        
        .promo-input {
            flex: 1;
            padding: 1.5vh;
            border: 1px solid #ccc;
            border-radius: 1vh;
            font-size: 2vh;
            text-align: center;
        }
        
        .promo-btn {
            padding: 1.5vh;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 1vh;
            cursor: pointer;
            font-size: 2vh;
            display: flex;
            justify-content: center;
            align-items: center;
            width: auto;
            min-width: 10vh;
        }
        
        .promo-btn:active {
            background: #3e8e41;
        }
        
        .promo-result {
            margin-top: 2vh;
            font-size: 2vh;
            color: #333;
            max-width: 100%;
            overflow-wrap: break-word;
        }
        
        .promo-error {
            color: #FF4500;
        }
        
        .promo-success {
            color: #4CAF50;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ –º–∞–≥–∞–∑–∏–Ω–∞ –ø–æ–¥ –∫–Ω–æ–ø–∫–∞–º–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ */
        .shop-btn-container {
            display: flex;
            justify-content: center;
            margin-top: 1vh;
        }
        
        .shop-btn {
            font-size: 2.5vh;
            cursor: pointer;
            transition: transform 0.2s;
            width: 5vh;
            height: 5vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 50%;
            box-shadow: 0 0 1vh rgba(0,0,0,0.2);
        }
        
        .shop-btn:active {
            transform: scale(0.8);
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö */
        .confirm-clear-modal {
            width: 80%;
            max-width: 300px;
        }
        
        .confirm-clear-text {
            font-size: 2.5vh;
            margin-bottom: 3vh;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ–∫—É–ø–∫–∏ */
        .purchase-modal {
            width: 80%;
            max-width: 300px;
        }
        
        .purchase-result {
            font-size: 2.5vh;
            margin-bottom: 3vh;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–∞—Å—Å–∞ */
        .pass-modal {
            width: 90%;
            max-width: 400px;
            height: 80vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            background-image: url('AETpassBg.png');
            background-size: cover;
        }

        .pass-header {
            width: 100%;
            height: 15vh;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 2vh;
        }

        .pass-header-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .pass-tabs {
            display: flex;
            justify-content: space-around;
            margin-bottom: 2vh;
        }

        .pass-tab {
            padding: 1vh 2vh;
            background: #f5f5f5;
            border-radius: 1vh;
            cursor: pointer;
            font-size: 2vh;
            display: flex;
            justify-content: center;
            align-items: center;
            min-width: 10vh;
        }

        .pass-tab.active {
            background: #FF4500;
            color: white;
        }

        .pass-container {
            flex-grow: 1;
            overflow-y: auto;
            padding: 1vh;
            display: flex;
            flex-direction: column;
        }

        .pass-item {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 1vh;
            padding: 1.5vh;
            margin-bottom: 2vh;
            display: flex;
            align-items: center;
            position: relative;
        }

        .pass-item-image {
            width: 10vh;
            height: 10vh;
            object-fit: contain;
            margin-right: 2vh;
        }

        .pass-item-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .pass-item-name {
            font-size: 2vh;
            font-weight: bold;
            margin-bottom: 1vh;
        }

        .pass-item-task {
            font-size: 1.8vh;
            color: #555;
            margin-bottom: 1vh;
        }

        .pass-progress-container {
            width: 100%;
            height: 1vh;
            background: #ddd;
            border-radius: 0.5vh;
            margin-top: 1vh;
            position: relative;
        }

        .pass-progress-bar {
            position: absolute;
            height: 100%;
            background: #FF4500;
            border-radius: 0.5vh;
            width: 0%;
            transition: width 0.3s;
        }

        .pass-item-premium {
            width: 10vh;
            height: 10vh;
            object-fit: contain;
            margin-left: 2vh;
            position: relative;
        }

        .pass-item-premium.locked::after {
            content: "üîí";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3vh;
        }


        .pass-item-claim {
            padding: 1vh 2vh;
            background: gold;
            color: #333;
            border: none;
            border-radius: 1vh;
            font-size: 2vh;
            font-weight: bold;
            cursor: pointer;
            margin-top: 1vh;
            display: flex;
            justify-content: center;
            align-items: center;
            min-width: 10vh;
        }

        .pass-item-claim-regular {
            background: #4CAF50;
            color: white;
            margin-right: 1vh;
        }

        .pass-item-claim-premium {
            background: gold;
            color: #333;
        }

        .selected-costume {
            border: 2px solid #4CAF50;
            background: #e8f5e9;
        }

        .pass-scrollbar {
            height: 0.5vh;
            background: #eee;
            border-radius: 0.5vh;
            margin-top: 1vh;
            position: relative;
        }

        .pass-scrollbar-thumb {
            position: absolute;
            height: 100%;
            background: #FF4500;
            border-radius: 0.5vh;
            width: 30%;
            left: 0;
        }

        .pass-footer {
            display: flex;
            justify-content: space-between;
            padding: 1vh;
            gap: 1vh;
        }

        .buy-pass-btn {
            padding: 1vh 2vh;
            background: gold;
            color: #333;
            border: none;
            border-radius: 1vh;
            font-size: 2vh;
            font-weight: bold;
            cursor: pointer;
            flex: 1;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–æ–ª—É—á–µ–Ω–∏–∏ */
        .reward-notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #4CAF50;
            color: white;
            padding: 1.5vh 3vh;
            border-radius: 2vh;
            font-size: 2.5vh;
            z-index: 1000;
            box-shadow: 0 0 2vh rgba(0,0,0,0.3);
            animation: slideIn 0.3s forwards, fadeOut 0.3s 2s forwards;
        }

        @keyframes slideIn {
            from { top: -100px; opacity: 0; }
            to { top: 20px; opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ø—Ä–µ–º–∏—É–º–∞ */
        .no-premium-modal {
            width: 90%;
            max-width: 350px;
            text-align: center;
        }

        .no-premium-image {
            width: 100%;
            max-height: 40vh;
            object-fit: contain;
            margin-bottom: 2vh;
        }

        /* –ù–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –≤ –ø–∞—Å—Å–µ */
        .pass-buttons-container {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-top: 1vh;
        }

        .pass-claimed-text {
            font-size: 1.8vh;
            color: #4CAF50;
            text-align: center;
            margin-top: 1vh;
            width: 100%;
        }

        .pass-claimed-text-premium {
            color: gold;
        }
    </style>
</head>
<body>
    <div class="phone">
        <div class="room" id="smileBg">
            <div class="level-container">
                <div class="level-display" id="levelDisplay">
                    <div class="level-progress" id="levelProgress"></div>
                    <div class="level-number">0</div>
                </div>
                <div class="buttons-container">
                    <div class="settings-btn costumes-btn">üëï</div>
                    <div class="settings-btn settings-btn">‚öôÔ∏è</div>
                    <div class="settings-btn shop-btn" id="shopBtn">üõí</div>
                    <div class="settings-btn pass-btn" id="passBtn">üé´</div>
                </div>
            </div>
            <div class="click-counter">
                <span id="clicks">0</span>
            </div>
            <div class="crystal-counter">
                <span id="crystals">0</span> üíé
            </div>
            <div class="alice-container" id="aliceContainer">
                <img id="alice" class="alice" src="Alice.png" alt="–ê–ª–∏—Å–∞">
            </div>
        </div>
        
        <div class="room" id="foodBg">
            <div class="level-container">
                <div class="level-display">
                    <div class="level-progress"></div>
                    <div class="level-number">0</div>
                </div>
                <div class="buttons-container">
                    <div class="settings-btn costumes-btn">üëï</div>
                    <div class="settings-btn settings-btn">‚öôÔ∏è</div>
                    <div class="settings-btn shop-btn" id="shopBtn2">üõí</div>
                    <div class="settings-btn pass-btn" id="passBtn2">üé´</div>
                </div>
            </div>
            <div class="alice-container" id="foodAliceContainer">
                <img class="alice" src="Alice.png" alt="–ê–ª–∏—Å–∞">
            </div>
            <div class="food-items" id="foodItems">
                <!-- –ï–¥–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>
        
        <div class="room" id="toiletBg">
            <div class="level-container">
                <div class="level-display">
                    <div class="level-progress"></div>
                    <div class="level-number">0</div>
                </div>
                <div class="buttons-container">
                    <div class="settings-btn costumes-btn">üëï</div>
                    <div class="settings-btn settings-btn">‚öôÔ∏è</div>
                    <div class="settings-btn shop-btn" id="shopBtn3">üõí</div>
                    <div class="settings-btn pass-btn" id="passBtn3">üé´</div>
                </div>
            </div>
            <div class="alice-container">
                <img class="alice" src="Alice.png" alt="–ê–ª–∏—Å–∞">
            </div>
            <!-- –î–≤–µ—Ä—å –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </div>
        
        <div class="room" id="sleepBg">
            <div class="level-container">
                <div class="level-display">
                    <div class="level-progress"></div>
                    <div class="level-number">0</div>
                </div>
                <div class="buttons-container">
                    <div class="settings-btn costumes-btn">üëï</div>
                    <div class="settings-btn settings-btn">‚öôÔ∏è</div>
                    <div class="settings-btn shop-btn" id="shopBtn4">üõí</div>
                    <div class="settings-btn pass-btn" id="passBtn4">üé´</div>
                </div>
            </div>
            <div class="alice-container">
                <img class="alice" src="Alice.png" alt="–ê–ª–∏—Å–∞">
            </div>
            <div class="dark-overlay" id="darkOverlay"></div>
            <div class="sleep-timer" id="sleepTimer">1:00</div>
        </div>
        
        <div class="light-switch" id="lightSwitch">üí°</div>
        
        <div class="buttons">
            <div class="btn" id="smileBtn" onclick="changeRoom('smileBg')">
                <div class="btn-progress" id="smileProgress"></div>
                <div class="btn-content">üòÄ</div>
            </div>
            <div class="btn" id="foodBtn" onclick="changeRoom('foodBg')">
                <div class="btn-progress" id="foodProgress"></div>
                <div class="btn-content">üç¥</div>
            </div>
            <div class="btn" id="toiletBtn" onclick="changeRoom('toiletBg')">
                <div class="btn-progress" id="toiletProgress"></div>
                <div class="btn-content">üöΩ</div>
            </div>
            <div class="btn" id="sleepBtn" onclick="changeRoom('sleepBg')">
                <div class="btn-progress" id="sleepProgress"></div>
                <div class="btn-content">üåô</div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal settings-modal">
            <div class="modal-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
            <div class="settings-option" id="howToPlay">–ö–∞–∫ –∏–≥—Ä–∞—Ç—å?</div>
            <div class="back-btn" id="backFromSettings">–ù–∞–∑–∞–¥</div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–æ—Å—Ç—é–º–æ–≤ -->
    <div class="modal-overlay" id="costumesModal">
        <div class="modal costumes-modal">
            <div class="modal-title">–ö–æ—Å—Ç—é–º—ã</div>
            <div class="costumes-container" id="costumesContainer">
                <!-- –ö–æ—Å—Ç—é–º—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            <div class="costume-scrollbar">
                <div class="costume-scrollbar-thumb" id="scrollbarThumb"></div>
            </div>
            <div class="back-btn" id="backFromCostumes">–ù–∞–∑–∞–¥</div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –º–∞–≥–∞–∑–∏–Ω–∞ -->
    <div class="modal-overlay" id="shopModal">
        <div class="modal shop-modal">
            <div class="modal-title">–ú–∞–≥–∞–∑–∏–Ω</div>
            <div class="shop-container" id="shopContainer">
                <!-- –ê–∫—Ü–∏–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            <div class="shop-scrollbar">
                <div class="shop-scrollbar-thumb" id="shopScrollbarThumb"></div>
            </div>
            <div class="promo-section">
                <input type="text" class="promo-input" id="promoCodeInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥">
                <button class="promo-btn" id="applyPromoBtn">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
            <div class="promo-result" id="promoResult"></div>
            <div class="back-btn" id="backFromShop">–ù–∞–∑–∞–¥</div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ -->
    <div class="modal-overlay" id="manualModal">
        <div class="modal" style="max-width: 400px;">
            <div class="modal-title">–ö–∞–∫ –∏–≥—Ä–∞—Ç—å</div>
            <img src="1Manual.png" class="manual-image" id="manualImage" alt="–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è">
            <div class="manual-buttons">
                <div class="manual-btn manual-btn-prev" id="prevManualBtn" style="display: none;">–ù–∞–∑–∞–¥</div>
                <div class="manual-btn manual-btn-next" id="nextManualBtn">–î–∞–ª–µ–µ</div>
                <div class="manual-btn manual-btn-done" id="doneManualBtn" style="display: none;">–ì–æ—Ç–æ–≤–æ!</div>
            </div>
            <div class="back-btn" id="backFromManual">–ù–∞–∑–∞–¥</div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö -->
    <div class="modal-overlay" id="confirmClearModal">
        <div class="modal confirm-clear-modal">
            <div class="modal-title">–û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö</div>
            <div class="confirm-clear-text">–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã?</div>
            <div class="modal-buttons">
                <div class="modal-btn modal-btn-yes" id="confirmClearBtn">–î–∞</div>
                <div class="modal-btn modal-btn-no" id="cancelClearBtn">–ù–µ—Ç</div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–æ–∫—É–ø–∫–∏ -->
    <div class="modal-overlay" id="purchaseModal">
        <div class="modal purchase-modal">
            <div class="modal-title">–ü–æ–∫—É–ø–∫–∞</div>
            <div class="purchase-result" id="purchaseResult"></div>
            <div class="back-btn" id="backFromPurchase">–û–ö</div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–∞—Å—Å–∞ -->
    <div class="modal-overlay" id="passModal">
        <div class="modal pass-modal">
            <div class="pass-header">
                <img src="aetpasstitle.png" class="pass-header-image" alt="AET Pass">
            </div>
            <div class="pass-tabs">
                <div class="pass-tab active" id="passTab">–ü–∞—Å—Å</div>
                <div class="pass-tab" id="questsTab">–ö–≤–µ—Å—Ç—ã</div>
            </div>
            <div class="pass-container" id="passContainer">
                <!-- –ü–∞—Å—Å –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            <div class="pass-footer">
                <div class="back-btn" id="backFromPass">–ù–∞–∑–∞–¥</div>
                <button class="buy-pass-btn" id="buyPassBtn">–ö—É–ø–∏—Ç—å –∑–∞ 79üíé</button>
            </div>
            <div class="pass-scrollbar">
                <div class="pass-scrollbar-thumb" id="passScrollbarThumb"></div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ø—Ä–µ–º–∏—É–º–∞ -->
    <div class="modal-overlay" id="noPremiumModal">
        <div class="modal no-premium-modal">
            <div class="modal-title">AET Premium Pass</div>
            <div class="back-btn" id="backFromNoPremium">–û–ö</div>
        </div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–æ–ª—É—á–µ–Ω–∏–∏ -->
    <div class="reward-notification" id="rewardNotification" style="display: none;"></div>

    <script>
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Å—Å–∞
        const passConfig = {
            Season: 1, // –ù–æ–º–µ—Ä —Å–µ–∑–æ–Ω–∞ (–º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å)
            PassPng: "aetpasstitle.png", // –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–∞—Å—Å–∞ (–≤–µ—Ä—Ö–Ω—è—è —á–∞—Å—Ç—å)
            PassBg: "AETpassBg.png" // –§–æ–Ω –ø–∞—Å—Å–∞
        };

        let clickCount = localStorage.getItem('aliceClickCount') ? parseInt(localStorage.getItem('aliceClickCount')) : 0;
        let xp = localStorage.getItem('aliceXP') ? parseInt(localStorage.getItem('aliceXP')) : 0;
        let level = localStorage.getItem('aliceLevel') ? parseInt(localStorage.getItem('aliceLevel')) : 0;
        let selectedCostume = localStorage.getItem('aliceSelectedCostume') || 'default';
        let usedPromoCodes = JSON.parse(localStorage.getItem('aliceUsedPromoCodes')) || [];
        let crystals = localStorage.getItem('aliceCrystals') ? parseInt(localStorage.getItem('aliceCrystals')) : 0;
        let tokens = localStorage.getItem(`aliceTokens_season_${passConfig.Season}`) ? parseInt(localStorage.getItem(`aliceTokens_season_${passConfig.Season}`)) : 0;
        let hasPremiumPass = localStorage.getItem(`aliceHasPremiumPass_season_${passConfig.Season}`) === 'true';
        let manualPage = 1;
        const maxManualPages = 3;
        
        // –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–ª–∏–∫–æ–≤ –¥–ª—è –∫–≤–µ—Å—Ç–æ–≤
        let questClicks = JSON.parse(localStorage.getItem('aliceQuestClicks')) || {
            clicksForQuests: 0,
            lastResetTime: Date.now()
        };
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∫–ª–∏–∫–∞–º–∏ (–≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö)
        const clickDelay = 150; // 200ms –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∫–ª–∏–∫–∞–º–∏
        let lastClickTime = 0;
        
        // –°–æ—Å—Ç–æ—è–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π
        let actionsCompleted = JSON.parse(localStorage.getItem('aliceActionsCompleted')) || {
            smile: false,
            food: false,
            toilet: false,
            sleep: false
        };
        
        // –ü—Ä–æ–≥—Ä–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
        let actionsProgress = JSON.parse(localStorage.getItem('aliceActionsProgress')) || {
            smile: 0,
            food: 0,
            toilet: 0,
            sleep: 0
        };
        
        // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ—Å—Ç—é–º–∞—Ö
        const costumes = {
            default: {
                name: "–ê–ª–∏—Å–∞",
                titleImage: "TitleAlice.png",
                mainImage: "Alice.png",
                tapImage: "AliceTap.png",
                clicksRequired: 0,
                levelRequired: 0,
                infoText: "–ò–∑–Ω–∞—á–∞–ª—å–Ω—ã–π",
                priceText: "–ë–µ—Å–ø–ª–∞—Ç–Ω–æ"
            },
            old: {
                name: "–ê–ª–∏—Å–∞ –û–ª–¥",
                titleImage: "TitleAliceOld.png",
                mainImage: "AliceOld.png",
                tapImage: "AliceTapOld.png",
                clicksRequired: 50,
                levelRequired: 0,
                infoText: "–†–µ–¥–∫–∏–π",
                priceText: "50 –∫–ª–∏–∫–æ–≤"
            },
            pink: {
                name: "–ê–ª–∏—Å–∞ –≤ —Ä–æ–∑–æ–≤–æ–π –∫–æ—Ñ—Ç–µ",
                titleImage: "TitleAlicePink.png",
                mainImage: "AlicePink.png",
                tapImage: "AliceTapPink.png",
                clicksRequired: 0,
                levelRequired: 1,
                infoText: "–†–µ–¥–∫–∏–π",
                priceText: "–£—Ä–æ–≤–µ–Ω—å 1"
            },
			withoutashirt: {
                name: "–ê–ª–∏—Å–∞ –±–µ–∑ —Ä—É–±–∞—à–∫–∏",
                titleImage: "TitleAliceWithoutAshirt.png",
                mainImage: "AliceWithoutAshirt.png",
                tapImage: "AliceTapWithoutAshirt.png",
                clicksRequired: 0,
                levelRequired: 3,
                infoText: "–°–≤–µ—Ä—Ö—Ä–µ–¥–∫–∏–π",
                priceText: "–£—Ä–æ–≤–µ–Ω—å 3"
            },
            toy: {
                name: "–ò–≥—Ä—É—à–∫–∞ –ê–ª–∏—Å–∞",
                titleImage: "TitleAliceToy.png",
                mainImage: "AliceToy.png",
                tapImage: "AliceTapToy.png",
                clicksRequired: 0,
                levelRequired: 5,
                infoText: "–≠–ø–∏—á–µ—Å–∫–∏–π",
                priceText: "–£—Ä–æ–≤–µ–Ω—å 5"
            },
			stylish: {
                name: "–°—Ç–∏–ª—å–Ω–∞—è –ê–ª–∏—Å–∞",
                titleImage: "TitleAliceStylish.png",
                mainImage: "AliceStylish.png",
                tapImage: "AliceTapStylish.png",
                clicksRequired: 0,
                levelRequired: 10,
                infoText: "–≠–ø–∏—á–µ—Å–∫–∏–π",
                priceText: "–£—Ä–æ–≤–µ–Ω—å 10"
            },
			sanyastylish: {
                name: "–°—Ç–∏–ª—å–Ω—ã–π –°–∞–Ω—è",
                titleImage: "TitleSanyaStylish.png",
                mainImage: "SanyaStylish.png",
                tapImage: "SanyaTapStylish.png",
                clicksRequired: 0,
                levelRequired: 10000000000,
                infoText: "–≠–ø–∏—á–µ—Å–∫–∏–π",
                priceText: "–ò—â–∏—Ç–µ –≤ –º–∞–≥–∞–∑–∏–Ω–µ"
            },
            tenna: {
                name: "–¢–µ–Ω–Ω–∞",
                titleImage: "TitleTenna.png",
                mainImage: "AliceTenna.png",
                tapImage: "AliceTapTenna.png",
                clicksRequired: 0,
                levelRequired: 10000,
                infoText: "–ú–∏—Ñ–∏—á–µ—Å–∫–∏–π",
                priceText: "–ü—Ä–æ–º–æ–∫–æ–¥"
            },
            mudriycat: {
                name: "–ú—É–¥—Ä—ã–π –∫–æ—Ç",
                titleImage: "TitleMudriyCat.png",
                mainImage: "AliceMudriyCat.png",
                tapImage: "AliceTapMudriyCat.png",
                clicksRequired: 0,
                levelRequired: 100000,
                infoText: "–ú–∏—Ñ–∏—á–µ—Å–∫–∏–π",
                priceText: "–ü—Ä–æ–º–æ–∫–æ–¥"
            },
			alicesanya: {
                name: "–ê–ª–∏—Å–∞ –≤ –∫–æ—Å—Ç—é–º–µ –°–∞–Ω–∏",
                titleImage: "TitleAliceSanya.png",
                mainImage: "AliceSanya.png",
                tapImage: "AliceTapSanya.png",
                clicksRequired: 1000,
                levelRequired: 0,
                infoText: "–ú–∏—Ñ–∏—á–µ—Å–∫–∏–π",
                priceText: "1.000 –∫–ª–∏–∫–æ–≤"
            },
            gold: {
                name: "–ó–æ–ª–æ—Ç–∞—è –ê–ª–∏—Å–∞",
                titleImage: "TitleAliceGold.png",
                mainImage: "AliceGold.png",
                tapImage: "AliceTapGold.png",
                clicksRequired: 5000,
                levelRequired: 0,
                infoText: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π",
                priceText: "5.000 –∫–ª–∏–∫–æ–≤"
            },
			alicefangirl: {
                name: "–ê–ª–∏—Å–∞ –§–∞–Ω –ì—ë—Ä–ª",
                titleImage: "TitleAliceFanGirl.png",
                mainImage: "AliceFanGirl.png",
                tapImage: "AliceTapFanGirl.png",
                clicksRequired: 0,
                levelRequired: 10000000,
                infoText: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π",
                priceText: "–ü—Ä–æ–º–æ–∫–æ–¥"
            },
            sanya: {
                name: "–°–∞–Ω—è",
                titleImage: "TitleSanya.png",
                mainImage: "Sanya.png",
                tapImage: "SanyaTap.png",
                clicksRequired: 0,
                levelRequired: 24,
                infoText: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π",
                priceText: "–ò—â–∏—Ç–µ –≤ –º–∞–≥–∞–∑–∏–Ω–µ"
            },
            alicespir: {
                name: "–ê–ª–∏—Å–∞ –≤ –∫–æ—Å—Ç—é–º–µ –°–ø–∏—Ä –¢–∏—Ä–∞",
                titleImage: "TitleAliceSpirTir.png",
                mainImage: "AliceSpirTir.png",
                tapImage: "AliceTapSpirTir.png",
                clicksRequired: 0,
                levelRequired: 1000000,
                infoText: "–°–µ–∑–æ–Ω–Ω—ã–π",
                priceText: "–°–µ–∑–æ–Ω 1 (–ë–µ—Å–ø–ª–∞—Ç–Ω–æ)"
            },
			spirtir: {
                name: "–°–ø–∏—Ä —Ç–∏—Ä",
                titleImage: "TitleSpirTir.png",
                mainImage: "SpirTir.png",
                tapImage: "SpirTirTap.png",
                clicksRequired: 0,
                levelRequired: 1000000,
                infoText: "–°–µ–∑–æ–Ω–Ω—ã–π",
                priceText: "–°–µ–∑–æ–Ω 1 (AET Premium Pass)"
            }
        };        
        // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ—Å—Ç—é–º—ã
        let unlockedCostumes = JSON.parse(localStorage.getItem('aliceUnlockedCostumes')) || {
            default: true,
            old: false,
            pink: false,
			withoutashirt: false,
			toy: false,
			stylish: false,			
			sanyastylish: false,
            tenna: false,
            mudriycat: false,
			alicesanya: false,
            gold: false,
            alicefangirl: false,
			sanya: false,
			alicespir: false,			
			alicespir: false
        };
        
        // –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)
        const promoCodes = {
            "PSYCHE": { type: "clicks", value: 24 },
            "ALICE100": { type: "clicks", value: 100 },
            "REDLLOWSHINE": { type: "clicks", value: 50 },
            "MYALICEMOBILE": { type: "clicks", value: 50 },
			"HOTLEGS": { type: "clicks", value: 100 },
			"KISS": { type: "clicks", value: 50 },			
            "CRYSTALAUGUSTUPDATE": { type: "crystals", value: 10 },
            "DELTARUNETENNASKIN2025": { type: "costume", value: "tenna" },
            "TIKTOKMUDRIYCATSKIN": { type: "costume", value: "mudriycat" },
            "OLDMODELALICEFANGIRL": { type: "costume", value: "alicefangirl" },				
						
            "2OJF94YEIQ": { type: "clicks", value: 10000 },   // –ü–ª–∞—Ç–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥
            "R5T8M3Q9X2": { type: "clicks", value: 5000 },   // –ü–ª–∞—Ç–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥
            "S2J7M5K3N8": { type: "crystals", value: 79 }, // –ü–ª–∞—Ç–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥
			"7H2K9D4L1P": { type: "crystals", value: 149 },  // –ü–ª–∞—Ç–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥ 
			"16TZQ0VART": { type: "crystals", value: 249 },  // –ü–ª–∞—Ç–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥ 
        };
        
        // –ê–∫—Ü–∏–∏ –≤ –º–∞–≥–∞–∑–∏–Ω–µ (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)
        const stocks = {
            stock0: {
                type: "clicks",
                value: 50,
                price: { type: "free" },
                requirements: { clicks: 0, level: 0 },
                title: "Stock0Title.png",
                name: "–ü–û–î–ê–†–û–ö!",
                description: "50 –∫–ª–∏–∫–æ–≤"
            },
            stock1: {
                type: "crystals",
                value: 5,
                price: { type: "free" },
                requirements: { clicks: 0, level: 0 },
                title: "Stock1Title.png",
                name: "–ü–û–î–ê–†–û–ö!",
                description: "5 –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤"
			},	
			stock2: {
                type: "costume", // –ú–æ–∂–µ—Ç –±—ã—Ç—å "costume", "clicks", "crystals", "pass"
                value: ["sanya"], // –ö–æ—Å—Ç—é–º –∏ –∫–ª–∏–∫–∏
                price: { type: "crystals", value: 29 }, // –¶–µ–Ω–∞ –≤ –∫–ª–∏–∫–∞—Ö
                requirements: { clicks: 0, level: 0 }, // –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –ø–æ—è–≤–ª–µ–Ω–∏—è
                title: "StockSanyaTitle.png",
                name: "–°–∞–Ω—è",
                description: "–°–∞–Ω—è"
            },	
			stock3: {
                type: "costume", // –ú–æ–∂–µ—Ç –±—ã—Ç—å "costume", "clicks", "crystals", "pass"
                value: ["stylish", "sanyastylish"], // –ö–æ—Å—Ç—é–º –∏ –∫–ª–∏–∫–∏
                price: { type: "crystals", value: 49 }, // –¶–µ–Ω–∞ –≤ –∫–ª–∏–∫–∞—Ö
                requirements: { clicks: 0, level: 0 }, // –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –ø–æ—è–≤–ª–µ–Ω–∏—è
                title: "StockRetroTitle.png",
                name: "–°–∫–∏–Ω—ã –∫–æ–ª–ª–µ–∫—Ü–∏–∏ —Ä–µ—Ç—Ä–æ!",
                description: "–†–µ—Ç—Ä–æ —Å–∫–∏–Ω—ã"
            }
        };
        
        // –ü–∞—Å—Å –Ω–∞–≥—Ä–∞–¥—ã
        const passRewards = {
            1: {
                png: "pass5clicks.png",
                pngPremium: "passPremium30clicks.png",
                giftUsually: { type: "clicks", value: 5 },
                giftPremium: { type: "clicks", value: 30 }, // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 100
            },
			2: {
                png: "pass10clicks.png",
                pngPremium: "passPremium40clicks.png",
                giftUsually: { type: "clicks", value: 10 },
                giftPremium: { type: "clicks", value: 40 }, // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 250
            },
			3: {
                png: "pass5clicks.png",
                pngPremium: "passPremium50clicks.png",
                giftUsually: { type: "clicks", value: 5 },
                giftPremium: { type: "clicks", value: 50 }, // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 400
            },
			4: {
                png: "pass10clicks.png",
                pngPremium: "passPremium40clicks.png",
                giftUsually: { type: "clicks", value: 10 },
                giftPremium: { type: "clicks", value: 40 }, // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 550
            },
			5: {
                png: "pass10crystals.png",
                pngPremium: "passPremium20crystals.png",
                giftUsually: { type: "crystals", value: 10 },
                giftPremium: { type: "crystals", value: 20 }, // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 700
            },
			6: {
                png: "pass10clicks.png",
                pngPremium: "passPremium30clicks.png",
                giftUsually: { type: "clicks", value: 10 },
                giftPremium: { type: "clicks", value: 30 }, // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 850
            },
			7: {
                png: "pass5clicks.png",
                pngPremium: "passPremium40clicks.png",
                giftUsually: { type: "clicks", value: 5 },
                giftPremium: { type: "clicks", value: 40 }, // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 1000
            },
			8: {
                png: "pass10clicks.png",
                pngPremium: "passPremium50clicks.png",
                giftUsually: { type: "clicks", value: 10 },
                giftPremium: { type: "clicks", value: 50 }, // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 1150
            },
			9: {
                png: "pass5clicks.png",
                pngPremium: "passPremium40clicks.png",
                giftUsually: { type: "clicks", value: 5 },
                giftPremium: { type: "clicks", value: 40 }, // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 1300
            },
			10: {
                png: "pass10crystals.png",
                pngPremium: "passPremium10crystals.png",
                giftUsually: { type: "crystals", value: 10 },
                giftPremium: { type: "crystals", value: 10 }, // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 1600
            },
			11: {
                png: "pass10clicks.png",
                pngPremium: "passPremium30clicks.png",
                giftUsually: { type: "clicks", value: 10 },
                giftPremium: { type: "clicks", value: 30 },  // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 1750
            },
			12: {
                png: "pass20clicks.png",
                pngPremium: "passPremium40clicks.png",
                giftUsually: { type: "clicks", value: 20 },
                giftPremium: { type: "clicks", value: 40 },  // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 1900
            },
			13: {
                png: "pass10clicks.png",
                pngPremium: "passPremium50clicks.png",
                giftUsually: { type: "clicks", value: 10 },
                giftPremium: { type: "clicks", value: 50 },   // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 2050
            },
			14: {
                png: "pass20clicks.png",
                pngPremium: "passPremium40clicks.png",
                giftUsually: { type: "clicks", value: 20 },
                giftPremium: { type: "clicks", value: 40 },  // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 2200
            },
			15: {
                png: "pass10crystals.png",
                pngPremium: "passPremium20crystals.png",
                giftUsually: { type: "crystals", value: 10 },
                giftPremium: { type: "crystals", value: 20 },   // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 2500
            },
			16: {
                png: "pass10clicks.png",
                pngPremium: "passPremium30clicks.png",
                giftUsually: { type: "clicks", value: 10 },
                giftPremium: { type: "clicks", value: 30 },  // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 2650
            },
			17: {
                png: "pass20clicks.png",
                pngPremium: "passPremium40clicks.png",
                giftUsually: { type: "clicks", value: 20 },
                giftPremium: { type: "clicks", value: 40 },  // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 2800
            },
			18: {
                png: "pass10clicks.png",
                pngPremium: "passPremium50clicks.png",
                giftUsually: { type: "clicks", value: 10 },
                giftPremium: { type: "clicks", value: 50 },  // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 2950
            },
			19: {
                png: "pass20clicks.png",
                pngPremium: "passPremium40clicks.png",
                giftUsually: { type: "clicks", value: 20 },
                giftPremium: { type: "clicks", value: 40 },  // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 3100
            },
			20: {
                png: "pass20crystals.png",
                pngPremium: "passPremium10crystals.png",
                giftUsually: { type: "crystals", value: 20 },
                giftPremium: { type: "crystals", value: 10 },   // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 3400
            },
			21: {
                png: "pass10clicks.png",
                pngPremium: "passPremium30clicks.png",
                giftUsually: { type: "clicks", value: 10 },
                giftPremium: { type: "clicks", value: 30 },   // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 3550
            },
			22: {
                png: "pass20clicks.png",
                pngPremium: "passPremium40clicks.png",
                giftUsually: { type: "clicks", value: 20 },
                giftPremium: { type: "clicks", value: 40 },   // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 3700
            },
			23: {
                png: "pass10clicks.png",
                pngPremium: "passPremium50clicks.png",
                giftUsually: { type: "clicks", value: 10 },
                giftPremium: { type: "clicks", value: 50 },  // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 3850
            },
			24: {
                png: "pass20clicks.png",
                pngPremium: "passPremium40clicks.png",
                giftUsually: { type: "clicks", value: 20 },
                giftPremium: { type: "clicks", value: 40 },  // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 4000
            },
            25: {
                png: "pass10crystals.png",
                pngPremium: "passPremium10crystals.png",
                giftUsually: { type: "crystals", value: 10 },
                giftPremium: { type: "crystals", value: 10 },  // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 4300
            },
			26: {
                png: "pass10clicks.png",
                pngPremium: "passPremium30clicks.png",
                giftUsually: { type: "clicks", value: 10 },
                giftPremium: { type: "clicks", value: 30 },  // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 4450
            },
			27: {
                png: "pass20clicks.png",
                pngPremium: "passPremium40clicks.png",
                giftUsually: { type: "clicks", value: 20 },
                giftPremium: { type: "clicks", value: 40 },  // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 4600
            },
			28: {
                png: "pass10crystals.png",
                pngPremium: "passPremium10crystals.png",
                giftUsually: { type: "crystals", value: 10 },
                giftPremium: { type: "crystals", value: 10 },  // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 4750
            },
			29: {
                png: "pass20clicks.png",
                pngPremium: "passPremium50clicks.png",
                giftUsually: { type: "clicks", value: 20 },
                giftPremium: { type: "clicks", value: 50 },  // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 4850
            },
            30: {
                png: "TitleAliceSpirTir.png",
                pngPremium: "TitleSpirTir.png",
                giftUsually: { type: "costume", value: "alicespir" },
                giftPremium: { type: "costume", value: "spirtir" },  // –°–¥–µ–ª–∞–Ω–æ
                needTokens: 5000
            }
        };
        
        // –ö–≤–µ—Å—Ç—ã
        const quests = {
 		    0: {
                need: { level: 100000 },
                giftTokens: 0,
                name: "50 —Ç–æ–∫–µ–Ω–æ–≤ –∏ 1 –∫—Ä–∏—Å—Ç–∞–ª–ª",
                giftnameText: "50 —Ç–æ–∫–µ–Ω–æ–≤ –∏ 1 –∫—Ä–∏—Å—Ç–∞–ª–ª",
                png: "quest1.png",
                description: "–ü–æ–ª—É—á–∞–π—Ç–µ 50 —Ç–æ–∫–µ–Ω–æ–≤ –∏ 1 –∫—Ä–∏—Å—Ç–∞–ª–ª –∑–∞ 4 –ø—Ä–æ–π–¥–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –≤ 4 –∫–æ–º–Ω–∞—Ç–∞—Ö!"
            },
            1: {
                need: { clicks: 10 },
                giftTokens: 50,
                name: "50 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "50 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest1.png",
                description: "–°–¥–µ–ª–∞–π—Ç–µ 10 –∫–ª–∏–∫–æ–≤"
            },
            2: {
                need: { level: 5 },
                giftTokens: 100,
                name: "100 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "100 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest2.png",
                description: "–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 5 —É—Ä–æ–≤–Ω—è"
            },
            3: {
                need: { clicks: 50 },
                giftTokens: 200,
                name: "200 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "200 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest3.png",
                description: "–°–¥–µ–ª–∞–π—Ç–µ 50 –∫–ª–∏–∫–æ–≤"
            },
            4: {
                need: { level: 10 },
                giftTokens: 300,
                name: "300 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "300 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest4.png",
                description: "–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 10 —É—Ä–æ–≤–Ω—è"
            },
            5: {
                need: { clicks: 100 },
                giftTokens: 50,
                name: "50 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "50 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest1.png",
                description: "–°–¥–µ–ª–∞–π—Ç–µ 100 –∫–ª–∏–∫–æ–≤"
            },
            6: {
                need: { level: 15 },
                giftTokens: 100,
                name: "100 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "100 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest2.png",
                description: "–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 15 —É—Ä–æ–≤–Ω—è"
            },
            7: {
                need: { clicks: 200 },
                giftTokens: 200,
                name: "200 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "200 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest3.png",
                description: "–°–¥–µ–ª–∞–π—Ç–µ 200 –∫–ª–∏–∫–æ–≤"
            },
            8: {
                need: { level: 20 },
                giftTokens: 300,
                name: "300 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "300 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest4.png",
                description: "–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 20 —É—Ä–æ–≤–Ω—è"
            },
            9: {
                need: { clicks: 300 },
                giftTokens: 50,
                name: "50 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "50 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest1.png",
                description: "–°–¥–µ–ª–∞–π—Ç–µ 300 –∫–ª–∏–∫–æ–≤"
            },
            10: {
                need: { level: 25 },
                giftTokens: 100,
                name: "100 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "100 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest2.png",
                description: "–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 25 —É—Ä–æ–≤–Ω—è"
            },
            11: {
                need: { clicks: 400 },
                giftTokens: 200,
                name: "200 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "200 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest3.png",
                description: "–°–¥–µ–ª–∞–π—Ç–µ 400 –∫–ª–∏–∫–æ–≤"
            },
            12: {
                need: { level: 30 },
                giftTokens: 300,
                name: "300 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "300 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest4.png",
                description: "–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 30 —É—Ä–æ–≤–Ω—è"
            },
            13: {
                need: { clicks: 500 },
                giftTokens: 50,
                name: "50 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "50 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest1.png",
                description: "–°–¥–µ–ª–∞–π—Ç–µ 500 –∫–ª–∏–∫–æ–≤"
            },
            14: {
                need: { level: 35 },
                giftTokens: 100,
                name: "100 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "100 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest2.png",
                description: "–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 35 —É—Ä–æ–≤–Ω—è"
            },
            15: {
                need: { clicks: 600 },
                giftTokens: 200,
                name: "200 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "200 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest3.png",
                description: "–°–¥–µ–ª–∞–π—Ç–µ 600 –∫–ª–∏–∫–æ–≤"
            },
            16: {
                need: { level: 40 },
                giftTokens: 300,
                name: "300 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "300 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest4.png",
                description: "–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 40 —É—Ä–æ–≤–Ω—è"
            },
            17: {
                need: { clicks: 700 },
                giftTokens: 50,
                name: "50 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "50 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest1.png",
                description: "–°–¥–µ–ª–∞–π—Ç–µ 700 –∫–ª–∏–∫–æ–≤"
            },
            18: {
                need: { level: 45 },
                giftTokens: 100,
                name: "100 —Ç–æ–∫–µ–Ω–æ–≤",
                giftnameText: "100 —Ç–æ–∫–µ–Ω–æ–≤",
                png: "quest2.png",
                description: "–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 45 —É—Ä–æ–≤–Ω—è"
            }
        };			
        
        // –ö—É–ø–ª–µ–Ω–Ω—ã–µ –∞–∫—Ü–∏–∏
        let purchasedStocks = JSON.parse(localStorage.getItem('alicePurchasedStocks')) || {};
        
        // –î–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –∞–∫—Ü–∏–π
        let newStocks = JSON.parse(localStorage.getItem('aliceNewStocks')) || {};
        
        // –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã –ø–∞—Å—Å–∞
        let collectedPassRewards = JSON.parse(localStorage.getItem(`aliceCollectedPassRewards_season_${passConfig.Season}`)) || {};
        
        // –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∫–≤–µ—Å—Ç—ã
        let completedQuests = JSON.parse(localStorage.getItem('aliceCompletedQuests')) || {};
        
        const levelDisplay = document.getElementById('levelDisplay');
        const levelNumber = document.querySelector('.level-number');
        const levelProgress = document.getElementById('levelProgress');
        const clickCounter = document.getElementById('clicks');
        const crystalCounter = document.getElementById('crystals');
        const lightSwitch = document.getElementById('lightSwitch');
        const darkOverlay = document.getElementById('darkOverlay');
        const aliceContainer = document.getElementById('aliceContainer');
        const foodAliceContainer = document.getElementById('foodAliceContainer');
        const foodItems = document.getElementById('foodItems');
        const sleepTimer = document.getElementById('sleepTimer');
        const aliceImg = document.getElementById('alice');
        
        // Progress bars –¥–ª—è –∫–Ω–æ–ø–æ–∫
        const smileProgress = document.getElementById('smileProgress');
        const foodProgress = document.getElementById('foodProgress');
        const toiletProgress = document.getElementById('toiletProgress');
        const sleepProgress = document.getElementById('sleepProgress');
        
        // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
        const settingsModal = document.getElementById('settingsModal');
        const costumesModal = document.getElementById('costumesModal');
        const costumesContainer = document.getElementById('costumesContainer');
        const howToPlayBtn = document.getElementById('howToPlay');
        const shopBtn = document.getElementById('shopBtn');
        const shopBtn2 = document.getElementById('shopBtn2');
        const shopBtn3 = document.getElementById('shopBtn3');
        const shopBtn4 = document.getElementById('shopBtn4');
        const passBtn = document.getElementById('passBtn');
        const passBtn2 = document.getElementById('passBtn2');
        const passBtn3 = document.getElementById('passBtn3');
        const passBtn4 = document.getElementById('passBtn4');
        const backFromSettingsBtn = document.getElementById('backFromSettings');
        const backFromCostumesBtn = document.getElementById('backFromCostumes');
        const backFromShopBtn = document.getElementById('backFromShop');
        const backFromPassBtn = document.getElementById('backFromPass');
        const backFromManualBtn = document.getElementById('backFromManual');
        const backFromNoPremiumBtn = document.getElementById('backFromNoPremium');
        
        const manualModal = document.getElementById('manualModal');
        const manualImage = document.getElementById('manualImage');
        const prevManualBtn = document.getElementById('prevManualBtn');
        const nextManualBtn = document.getElementById('nextManualBtn');
        const doneManualBtn = document.getElementById('doneManualBtn');
        
        const shopModal = document.getElementById('shopModal');
        const shopContainer = document.getElementById('shopContainer');
        const promoCodeInput = document.getElementById('promoCodeInput');
        const applyPromoBtn = document.getElementById('applyPromoBtn');
        const promoResult = document.getElementById('promoResult');
        
        const purchaseModal = document.getElementById('purchaseModal');
        const purchaseResult = document.getElementById('purchaseResult');
        const backFromPurchaseBtn = document.getElementById('backFromPurchase');
        
        const passModal = document.getElementById('passModal');
        const passTab = document.getElementById('passTab');
        const questsTab = document.getElementById('questsTab');
        const passContainer = document.getElementById('passContainer');
        const buyPassBtn = document.getElementById('buyPassBtn');
        
        const noPremiumModal = document.getElementById('noPremiumModal');
        
        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–æ–ª—É—á–µ–Ω–∏–∏
        const rewardNotification = document.getElementById('rewardNotification');
        
        // –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
        const smileBtn = document.getElementById('smileBtn');
        const foodBtn = document.getElementById('foodBtn');
        const toiletBtn = document.getElementById('toiletBtn');
        const sleepBtn = document.getElementById('sleepBtn');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—á–∏—Å—Ç–∫–∏
        const confirmClearModal = document.getElementById('confirmClearModal');
        const confirmClearBtn = document.getElementById('confirmClearBtn');
        const cancelClearBtn = document.getElementById('cancelClearBtn');
        
        let isLightOn = true;
        let activeFoodItem = null;
        let startX, startY, offsetX, offsetY;
        let foodItemsEaten = 0;
        const foodTypes = ['üçî', 'üßÉ', 'ü•ê'];
        let isFoodSpawning = false;
        
        // –¢—É–∞–ª–µ—Ç–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let toiletDoor = null;
        let isDoorMoving = false;
        let doorTimeout = null;
        let toiletUsed = false;
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Å–Ω–∞
        let sleepTimeLeft = 60; // 1 –º–∏–Ω—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
        let sleepInterval = null;
        let isSleeping = false;
        let lastUpdateTime = 0;
        let sleepStartTime = 0;
        let accumulatedSleepTime = 0;

        function initAlice() {
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–Ω –ø–∞—Å—Å–∞ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
            document.querySelector('.pass-modal').style.backgroundImage = `url('${passConfig.PassBg}')`;
            
            updateCounters();
            setupAliceClick();
            updateButtonsState();
            checkActionsCompletion();
            updateLevelProgress();
            updateActionsProgress();
            loadSelectedCostume();
            
            // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ –∫–æ—Å—Ç—é–º–æ–≤ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
            document.querySelectorAll('.costumes-btn').forEach(btn => {
                btn.addEventListener('click', showCostumesModal);
            });
            
            document.querySelectorAll('.settings-btn').forEach(btn => {
                if (btn.classList.contains('costumes-btn') || btn.classList.contains('shop-btn') || btn.classList.contains('pass-btn')) return;
                btn.addEventListener('click', showSettingsModal);
            });
            
            // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –º–∞–≥–∞–∑–∏–Ω–∞
            shopBtn.addEventListener('click', showShopModal);
            shopBtn2.addEventListener('click', showShopModal);
            shopBtn3.addEventListener('click', showShopModal);
            shopBtn4.addEventListener('click', showShopModal);
            
            // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø–∞—Å—Å–∞
            passBtn.addEventListener('click', showPassModal);
            passBtn2.addEventListener('click', showPassModal);
            passBtn3.addEventListener('click', showPassModal);
            passBtn4.addEventListener('click', showPassModal);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø—Ä–æ–º–æ–∫–æ–¥–∞
            applyPromoBtn.addEventListener('click', applyPromoCode);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ—á–∏—Å—Ç–∫–∏
            confirmClearBtn.addEventListener('click', clearGameData);
            cancelClearBtn.addEventListener('click', hideConfirmClearModal);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞ –ø–æ–∫—É–ø–∫–∏
            backFromPurchaseBtn.addEventListener('click', hidePurchaseModal);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ø—Ä–µ–º–∏—É–º–∞
            backFromNoPremiumBtn.addEventListener('click', hideNoPremiumModal);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø–∞—Å—Å–∞
            passTab.addEventListener('click', () => switchPassTab('pass'));
            questsTab.addEventListener('click', () => switchPassTab('quests'));
            buyPassBtn.addEventListener('click', buyPremiumPass);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
            prevManualBtn.addEventListener('click', prevManualPage);
            nextManualBtn.addEventListener('click', nextManualPage);
            doneManualBtn.addEventListener('click', hideManualModal);
            backFromManualBtn.addEventListener('click', hideManualModal);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à–∏ 7
            document.addEventListener('keydown', function(e) {
                if (e.key === '7') {
                    clearGameData(); // –£–¥–∞–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
                }
            });
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—ã–µ –∞–∫—Ü–∏–∏ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
            checkNewStocks();
            checkQuestsCompletion();
            updateManualButtons();
        }
        
        function showRewardNotification(message) {
            rewardNotification.textContent = message;
            rewardNotification.style.display = 'block';
            
            setTimeout(() => {
                rewardNotification.style.display = 'none';
            }, 2500);
        }
        
        function checkQuestsCompletion() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –Ω—É–∂–Ω–æ –ª–∏ —Å–±—Ä–æ—Å–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤ –¥–ª—è –∫–≤–µ—Å—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –Ω–æ–≤–æ–º –¥–Ω–µ)
            const now = Date.now();
            const oneDay = 24 * 60 * 60 * 1000; // 24 —á–∞—Å–∞ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
            if (now - questClicks.lastResetTime > oneDay) {
                questClicks.clicksForQuests = 0;
                questClicks.lastResetTime = now;
                localStorage.setItem('aliceQuestClicks', JSON.stringify(questClicks));
            }
            
            for (const [key, quest] of Object.entries(quests)) {
                if (!completedQuests[key]) {
                    let completed = true;
                    
                    if (quest.need.clicks && questClicks.clicksForQuests < quest.need.clicks) {
                        completed = false;
                    }
                    
                    if (quest.need.level && level < quest.need.level) {
                        completed = false;
                    }
                    
                    if (completed) {
                        completedQuests[key] = true;
                        tokens += quest.giftTokens;
                        localStorage.setItem(`aliceTokens_season_${passConfig.Season}`, tokens.toString());
                        localStorage.setItem('aliceCompletedQuests', JSON.stringify(completedQuests));
                        
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∫–≤–µ—Å—Ç–∞
                        showRewardNotification(`–ü–æ–ª—É—á–µ–Ω–æ ${quest.giftTokens} —Ç–æ–∫–µ–Ω–æ–≤!`);
                    }
                }
            }
        }
        
        function showPassModal() {
            passModal.classList.add('active');
            switchPassTab('pass');
        }
        
        function hidePassModal() {
            passModal.classList.remove('active');
        }
        
        function showNoPremiumModal() {
            noPremiumModal.classList.add('active');
        }
        
        function hideNoPremiumModal() {
            noPremiumModal.classList.remove('active');
        }
        
        function buyPremiumPass() {
            if (hasPremiumPass) {
                showRewardNotification("–£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å AET Premium Pass!");
                return;
            }
            
            if (crystals < 79) {
                showRewardNotification("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤!");
                return;
            }
            
            crystals -= 79;
            hasPremiumPass = true;
            localStorage.setItem('aliceCrystals', crystals.toString());
            localStorage.setItem(`aliceHasPremiumPass_season_${passConfig.Season}`, 'true');
            updateCounters();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showRewardNotification("AET Premium Pass –∫—É–ø–ª–µ–Ω!");
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞—Å—Å
            setTimeout(() => {
                showPassRewards();
            }, 500);
        }
        
        function switchPassTab(tab) {
            if (tab === 'pass') {
                passTab.classList.add('active');
                questsTab.classList.remove('active');
                showPassRewards();
            } else {
                passTab.classList.remove('active');
                questsTab.classList.add('active');
                showQuests();
            }
        }
        
        function showPassRewards() {
            passContainer.innerHTML = '';
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–∞–≥—Ä–∞–¥—ã –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ç—Ä–µ–±—É–µ–º—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤
            const sortedRewards = Object.entries(passRewards).sort((a, b) => a[1].needTokens - b[1].needTokens);
            
            for (const [key, reward] of sortedRewards) {
                const passItem = document.createElement('div');
                passItem.className = 'pass-item';
                
                const isCollected = collectedPassRewards[key];
                const isPremiumCollected = collectedPassRewards[key + '_premium'];
                const hasEnoughTokens = tokens >= reward.needTokens;
                
                // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–∞—Å—Å–∞
                const passContent = document.createElement('div');
                passContent.className = 'pass-item-content';
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–¥–∞—Ä–∫–∞
                const regularImage = document.createElement('img');
                regularImage.src = reward.png;
                regularImage.className = 'pass-item-image';
                regularImage.alt = "–ü–æ–¥–∞—Ä–æ–∫";
                passItem.appendChild(regularImage);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç (–ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –∫–Ω–æ–ø–∫–∏)
                passItem.appendChild(passContent);
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–µ–º–∏—É–º –ø–æ–¥–∞—Ä–∫–∞
                const premiumImage = document.createElement('img');
                premiumImage.src = reward.pngPremium;
                premiumImage.className = `pass-item-premium ${hasPremiumPass ? '' : 'locked'}`;
                premiumImage.alt = "–ü—Ä–µ–º–∏—É–º –ø–æ–¥–∞—Ä–æ–∫";
                passItem.appendChild(premiumImage);
                
                // –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω–æ–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏
                if (hasEnoughTokens) {
                    // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–Ω–æ–ø–æ–∫
                    const buttonsContainer = document.createElement('div');
                    buttonsContainer.className = 'pass-buttons-container';
                    
                    // –ï—Å–ª–∏ –æ–±—ã—á–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫ –µ—â–µ –Ω–µ –ø–æ–ª—É—á–µ–Ω
                    if (!isCollected) {
                        // –ö–Ω–æ–ø–∫–∞ –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–¥–∞—Ä–∫–∞
                        const regularBtn = document.createElement('button');
                        regularBtn.className = 'pass-item-claim pass-item-claim-regular';
                        regularBtn.textContent = '–ó–ê–ë–†–ê–¢–¨';
                        regularBtn.addEventListener('click', () => collectPassReward(key, reward, false));
                        buttonsContainer.appendChild(regularBtn);
                    } else {
                        // –¢–µ–∫—Å—Ç "–ü–æ–ª—É—á–µ–Ω–æ" –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–¥–∞—Ä–∫–∞
                        const claimedText = document.createElement('div');
                        claimedText.className = 'pass-claimed-text';
                        claimedText.textContent = '–ü–æ–ª—É—á–µ–Ω–æ';
                        buttonsContainer.appendChild(claimedText);
                    }
                    
                    // –ï—Å–ª–∏ –ø—Ä–µ–º–∏—É–º –ø–æ–¥–∞—Ä–æ–∫ –µ—â–µ –Ω–µ –ø–æ–ª—É—á–µ–Ω –∏ –µ—Å—Ç—å –ø—Ä–µ–º–∏—É–º –¥–æ—Å—Ç—É–ø
                    if (hasPremiumPass && !isPremiumCollected) {
                        // –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø—Ä–µ–º–∏—É–º –ø–æ–¥–∞—Ä–∫–∞
                        const premiumBtn = document.createElement('button');
                        premiumBtn.className = 'pass-item-claim pass-item-claim-premium';
                        premiumBtn.textContent = '–ó–ê–ë–†–ê–¢–¨';
                        premiumBtn.addEventListener('click', () => collectPassReward(key, reward, true));
                        buttonsContainer.appendChild(premiumBtn);
                    } else if (hasPremiumPass && isPremiumCollected) {
                        // –¢–µ–∫—Å—Ç "–ü–æ–ª—É—á–µ–Ω–æ" –¥–ª—è –ø—Ä–µ–º–∏—É–º –ø–æ–¥–∞—Ä–∫–∞
                        const claimedText = document.createElement('div');
                        claimedText.className = 'pass-claimed-text pass-claimed-text-premium';
                        claimedText.textContent = '–ü–æ–ª—É—á–µ–Ω–æ';
                        buttonsContainer.appendChild(claimedText);
                    }
                    
                    passContent.appendChild(buttonsContainer);
                } else {
                    // –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω–æ–≤ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
                    const progressContainer = document.createElement('div');
                    progressContainer.className = 'pass-progress-container';
                    
                    const progressBar = document.createElement('div');
                    progressBar.className = 'pass-progress-bar';
                    progressBar.style.width = `${Math.min(100, (tokens / reward.needTokens) * 100)}%`;
                    
                    progressContainer.appendChild(progressBar);
                    passContent.appendChild(progressContainer);
                    
                    const progressText = document.createElement('div');
                    progressText.className = 'pass-item-name';
                    progressText.textContent = `${tokens} / ${reward.needTokens}`;
                    passContent.insertBefore(progressText, progressContainer);
                }
                
                passContainer.appendChild(passItem);
            }
            
            setupPassScroll();
        }
        
function collectPassReward(key, reward, isPremium) {
    let message = "–ü–æ–ª—É—á–µ–Ω–æ: ";
    
    if (isPremium && hasPremiumPass) {
        // –í—ã–¥–∞–µ–º –ø—Ä–µ–º–∏—É–º –Ω–∞–≥—Ä–∞–¥—É
        if (reward.giftPremium.type === "clicks") {
            clickCount += reward.giftPremium.value;
            message += `${reward.giftPremium.value} –∫–ª–∏–∫–æ–≤ (–ø—Ä–µ–º–∏—É–º)`;
        } else if (reward.giftPremium.type === "crystals") {
            crystals += reward.giftPremium.value;
            message += `${reward.giftPremium.value} –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤ (–ø—Ä–µ–º–∏—É–º)`;
        } else if (reward.giftPremium.type === "costume") {
            unlockedCostumes[reward.giftPremium.value] = true;
            message += `–∫–æ—Å—Ç—é–º "${costumes[reward.giftPremium.value].name}" (–ø—Ä–µ–º–∏—É–º)`;
        }
        
        // –ü–æ–º–µ—á–∞–µ–º –Ω–∞–≥—Ä–∞–¥—É –∫–∞–∫ –ø–æ–ª—É—á–µ–Ω–Ω—É—é
        collectedPassRewards[key + '_premium'] = true;
    } else {
        // –í—ã–¥–∞–µ–º –æ–±—ã—á–Ω—É—é –Ω–∞–≥—Ä–∞–¥—É
        if (reward.giftUsually.type === "clicks") {
            clickCount += reward.giftUsually.value;
            message += `${reward.giftUsually.value} –∫–ª–∏–∫–æ–≤`;
        } else if (reward.giftUsually.type === "crystals") {
            crystals += reward.giftUsually.value;
            message += `${reward.giftUsually.value} –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤`;
        } else if (reward.giftUsually.type === "costume") {
            unlockedCostumes[reward.giftUsually.value] = true;
            message += `–∫–æ—Å—Ç—é–º "${costumes[reward.giftUsually.value].name}"`;
        }
        
        // –ü–æ–º–µ—á–∞–µ–º –Ω–∞–≥—Ä–∞–¥—É –∫–∞–∫ –ø–æ–ª—É—á–µ–Ω–Ω—É—é
        collectedPassRewards[key] = true;
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
    localStorage.setItem('aliceClickCount', clickCount.toString());
    localStorage.setItem('aliceCrystals', crystals.toString());
    localStorage.setItem('aliceUnlockedCostumes', JSON.stringify(unlockedCostumes));
    localStorage.setItem(`aliceCollectedPassRewards_season_${passConfig.Season}`, JSON.stringify(collectedPassRewards));
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –∏ –ø–∞—Å—Å
    updateCounters();
    showPassRewards();
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    showRewardNotification(message);
}
        
        function showQuests() {
            passContainer.innerHTML = '';
            
            for (const [key, quest] of Object.entries(quests)) {
                const questItem = document.createElement('div');
                questItem.className = 'pass-item';
                
                const isCompleted = completedQuests[key];
                let progress = 0;
                
                if (quest.need.clicks) {
                    progress = Math.min(100, (questClicks.clicksForQuests / quest.need.clicks) * 100);
                } else if (quest.need.level) {
                    progress = Math.min(100, (level / quest.need.level) * 100);
                }
                
                questItem.innerHTML = `
                    <img src="${quest.png}" class="pass-item-image" alt="${quest.name}">
                    <div class="pass-item-content">
                        <div class="pass-item-name">${quest.name}</div>
                        <div class="pass-item-task">${quest.description}</div>
                        <div class="pass-progress-container">
                            <div class="pass-progress-bar" style="width: ${progress}%"></div>
                        </div>
                    </div>
                `;
                
                passContainer.appendChild(questItem);
            }
            
            setupPassScroll();
        }
        
        function setupPassScroll() {
            const container = passContainer;
            const scrollbar = document.getElementById('passScrollbarThumb');
            
            function updateScrollbar() {
                const scrollRatio = container.scrollTop / (container.scrollHeight - container.clientHeight);
                const thumbPosition = scrollRatio * (container.clientWidth - scrollbar.clientWidth);
                scrollbar.style.left = `${thumbPosition}px`;
            }
            
            container.addEventListener('scroll', updateScrollbar);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è —Å–∫—Ä–æ–ª–ª–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏ –ø–æ–ª–∑—É–Ω–∫–∞
            let isDragging = false;
            let startX;
            
            scrollbar.addEventListener('mousedown', function(e) {
                isDragging = true;
                startX = e.clientX;
                e.preventDefault();
            });
            
            scrollbar.addEventListener('touchstart', function(e) {
                isDragging = true;
                startX = e.touches[0].clientX;
                e.preventDefault();
            }, { passive: false });
            
            document.addEventListener('mousemove', function(e) {
                if (!isDragging) return;
                
                const deltaX = e.clientX - startX;
                const containerWidth = container.clientWidth;
                const scrollWidth = container.scrollWidth;
                
                const scrollRatio = deltaX / containerWidth;
                container.scrollTop = scrollRatio * (scrollWidth - container.clientWidth);
                
                startX = e.clientX;
            });
            
            document.addEventListener('touchmove', function(e) {
                if (!isDragging) return;
                
                const deltaX = e.touches[0].clientX - startX;
                const containerWidth = container.clientWidth;
                const scrollWidth = container.scrollWidth;
                
                const scrollRatio = deltaX / containerWidth;
                container.scrollTop = scrollRatio * (scrollWidth - container.clientWidth);
                
                startX = e.touches[0].clientX;
                e.preventDefault();
            }, { passive: false });
            
            document.addEventListener('mouseup', function() {
                isDragging = false;
            });
            
            document.addEventListener('touchend', function() {
                isDragging = false;
            });
            
            updateScrollbar();
        }
        
        function prevManualPage() {
            if (manualPage > 1) {
                manualPage--;
                updateManualPage();
            }
        }
        
        function nextManualPage() {
            if (manualPage < maxManualPages) {
                manualPage++;
                updateManualPage();
            }
        }
        
        function updateManualPage() {
            manualImage.src = `${manualPage}Manual.png`;
            updateManualButtons();
        }
        
        function updateManualButtons() {
            prevManualBtn.style.display = manualPage === 1 ? 'none' : 'block';
            
            if (manualPage === maxManualPages) {
                nextManualBtn.style.display = 'none';
                doneManualBtn.style.display = 'block';
            } else {
                nextManualBtn.style.display = 'block';
                doneManualBtn.style.display = 'none';
            }
        }
        
        function checkNewStocks() {
            for (const [key, stock] of Object.entries(stocks)) {
                // –ï—Å–ª–∏ –∞–∫—Ü–∏—è –µ—â–µ –Ω–µ –±—ã–ª–∞ –∫—É–ø–ª–µ–Ω–∞ –∏ —É—Å–ª–æ–≤–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
                if (!purchasedStocks[key] && clickCount >= stock.requirements.clicks && level >= stock.requirements.level) {
                    // –ï—Å–ª–∏ –∞–∫—Ü–∏—è –µ—â–µ –Ω–µ –±—ã–ª–∞ –æ—Ç–º–µ—á–µ–Ω–∞ –∫–∞–∫ –Ω–æ–≤–∞—è
                    if (newStocks[key] === undefined) {
                        newStocks[key] = true;
                        localStorage.setItem('aliceNewStocks', JSON.stringify(newStocks));
                    }
                }
            }
        }
        
        function showPurchaseModal(message) {
            purchaseResult.textContent = message;
            purchaseModal.classList.add('active');
        }
        
        function hidePurchaseModal() {
            purchaseModal.classList.remove('active');
        }
        
        function showConfirmClearModal() {
            confirmClearModal.classList.add('active');
        }
        
        function hideConfirmClearModal() {
            confirmClearModal.classList.remove('active');
        }
        
        function clearGameData() {
            // –û—á–∏—â–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ localStorage
            localStorage.removeItem('aliceClickCount');
            localStorage.removeItem('aliceXP');
            localStorage.removeItem('aliceLevel');
            localStorage.removeItem('aliceSelectedCostume');
            localStorage.removeItem('aliceUsedPromoCodes');
            localStorage.removeItem('aliceActionsCompleted');
            localStorage.removeItem('aliceActionsProgress');
            localStorage.removeItem('aliceUnlockedCostumes');
            localStorage.removeItem('alicePurchasedStocks');
            localStorage.removeItem('aliceNewStocks');
            localStorage.removeItem('aliceCrystals');
            localStorage.removeItem('aliceQuestClicks');
            
            // –£–¥–∞–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–∞—Å—Å–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Å–µ–∑–æ–Ω–∞
            localStorage.removeItem(`aliceTokens_season_${passConfig.Season}`);
            localStorage.removeItem(`aliceHasPremiumPass_season_${passConfig.Season}`);
            localStorage.removeItem(`aliceCollectedPassRewards_season_${passConfig.Season}`);
            
            localStorage.removeItem('aliceCompletedQuests');
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
            clickCount = 0;
            xp = 0;
            level = 0;
            crystals = 0;
            tokens = 0;
            hasPremiumPass = false;
            selectedCostume = 'default';
            usedPromoCodes = [];
            actionsCompleted = {
                smile: false,
                food: false,
                toilet: false,
                sleep: false
            };
            actionsProgress = {
                smile: 0,
                food: 0,
                toilet: 0,
                sleep: 0
            };
            unlockedCostumes = {
                default: true,
                pink: false,
                old: false
            };
            purchasedStocks = {};
            newStocks = {};
            collectedPassRewards = {};
            completedQuests = {};
            questClicks = {
                clicksForQuests: 0,
                lastResetTime: Date.now()
            };
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateCounters();
            updateLevelProgress();
            updateActionsProgress();
            updateButtonsState();
            loadSelectedCostume();
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–º–Ω–∞—Ç
            toiletUsed = false;
            if (toiletDoor) {
                openDoor();
            }
            
            // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –µ–¥—É
            if (document.getElementById('foodBg').style.display === 'block') {
                spawnFood();
            }
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–∞–π–º–µ—Ä —Å–Ω–∞
            if (sleepInterval) {
                clearInterval(sleepInterval);
                sleepInterval = null;
            }
            isSleeping = false;
            sleepTimer.style.display = 'none';
            
            hideConfirmClearModal();
        }
        
        function applyPromoCode() {
            const promoCode = promoCodeInput.value.trim().toUpperCase();
            const resultElement = promoResult;
            
            if (!promoCode) {
                resultElement.textContent = "–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥";
                resultElement.className = "promo-result promo-error";
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –ª–∏ —É–∂–µ —ç—Ç–æ—Ç –ø—Ä–æ–º–æ–∫–æ–¥
            if (usedPromoCodes.includes(promoCode)) {
                resultElement.textContent = "–≠—Ç–æ—Ç –ø—Ä–æ–º–æ–∫–æ–¥ —É–∂–µ –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω";
                resultElement.className = "promo-result promo-error";
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø—Ä–æ–º–æ–∫–æ–¥
            if (!promoCodes[promoCode]) {
                resultElement.textContent = "–ù–µ–≤–µ—Ä–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥";
                resultElement.className = "promo-result promo-error";
                return;
            }
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø—Ä–æ–º–æ–∫–æ–¥
            const promo = promoCodes[promoCode];
            let message = "–ü—Ä–æ–º–æ–∫–æ–¥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!";
            
            switch(promo.type) {
                case "clicks":
                    clickCount += promo.value;
                    localStorage.setItem('aliceClickCount', clickCount.toString());
                    message += ` –ü–æ–ª—É—á–µ–Ω–æ ${promo.value} –∫–ª–∏–∫–æ–≤.`;
                    break;
                    
                case "costume":
                    unlockedCostumes[promo.value] = true;
                    localStorage.setItem('aliceUnlockedCostumes', JSON.stringify(unlockedCostumes));
                    message += ` –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –∫–æ—Å—Ç—é–º "${costumes[promo.value].name}".`;
                    
                    // –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤—ã–π –∫–æ—Å—Ç—é–º, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ–º –µ–≥–æ
                    if (selectedCostume === 'default' && promo.value !== 'default') {
                        selectedCostume = promo.value;
                        localStorage.setItem('aliceSelectedCostume', selectedCostume);
                        loadSelectedCostume();
                    }
                    break;
                    
                case "crystals":
                    crystals += promo.value;
                    localStorage.setItem('aliceCrystals', crystals.toString());
                    message += ` –ü–æ–ª—É—á–µ–Ω–æ ${promo.value} –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤.`;
                    break;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–º–æ–∫–æ–¥ –≤ —Å–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö
            usedPromoCodes.push(promoCode);
            localStorage.setItem('aliceUsedPromoCodes', JSON.stringify(usedPromoCodes));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏
            updateCounters();
            checkUnlockedCostumes();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            resultElement.textContent = message;
            resultElement.className = "promo-result promo-success";
            
            // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
            promoCodeInput.value = "";
        }
        
        function loadSelectedCostume() {
            const costume = costumes[selectedCostume];
            if (costume) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–æ –≤—Å–µ—Ö –∫–æ–º–Ω–∞—Ç–∞—Ö
                document.querySelectorAll('.alice').forEach(img => {
                    img.src = costume.mainImage;
                });
                aliceImg.src = costume.mainImage;
            }
        }
        
        function addXP(amount) {
            xp += amount;
            localStorage.setItem('aliceXP', xp.toString());
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç–∏–≥–ª–∏ –ª–∏ –Ω–æ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è (XP –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è = 100 + (—Ç–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å * 20))
            const xpNeeded = 100 + (level * 20);
            if (xp >= xpNeeded) {
                level++;
                xp = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º XP –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è
                localStorage.setItem('aliceLevel', level.toString());
                localStorage.setItem('aliceXP', '0');
                updateCounters();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏—Å—å –ª–∏ –Ω–æ–≤—ã–µ –∫–æ—Å—Ç—é–º—ã
                checkUnlockedCostumes();
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—ã–µ –∞–∫—Ü–∏–∏
                checkNewStocks();
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–≤–µ—Å—Ç—ã
                checkQuestsCompletion();
            }
            
            updateLevelProgress();
        }
        
        function updateCounters() {
            document.querySelectorAll('.level-number').forEach(el => {
                el.textContent = level;
            });
            clickCounter.textContent = clickCount;
            crystalCounter.textContent = crystals;
        }
        
        function updateLevelProgress() {
            const xpNeeded = 100 + (level * 20);
            const progress = (xp / xpNeeded) * 100;
            document.querySelectorAll('.level-progress').forEach(el => {
                el.style.setProperty('--progress', `${progress}%`);
            });
        }
        
        function updateActionsProgress() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
            smileProgress.style.height = `${actionsProgress.smile}%`;
            foodProgress.style.height = `${actionsProgress.food}%`;
            toiletProgress.style.height = `${actionsProgress.toilet}%`;
            sleepProgress.style.height = `${actionsProgress.sleep}%`;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ localStorage
            localStorage.setItem('aliceActionsProgress', JSON.stringify(actionsProgress));
        }
        
        function updateButtonsState() {
            if (actionsCompleted.smile) smileBtn.classList.add('completed');
            else smileBtn.classList.remove('completed');
            
            if (actionsCompleted.food) foodBtn.classList.add('completed');
            else foodBtn.classList.remove('completed');
            
            if (actionsCompleted.toilet) toiletBtn.classList.add('completed');
            else toiletBtn.classList.remove('completed');
            
            if (actionsCompleted.sleep) sleepBtn.classList.add('completed');
            else sleepBtn.classList.remove('completed');
        }
        
        function setupAliceClick() {
            const costume = costumes[selectedCostume];
            const originalSrc = costume ? costume.mainImage : 'Alice.png';
            const tapSrc = costume ? costume.tapImage : 'AliceTap.png';
            
            aliceContainer.addEventListener('click', function() {
                const now = Date.now();
                if (now - lastClickTime < clickDelay) return; // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–¥–µ—Ä–∂–∫—É –º–µ–∂–¥—É –∫–ª–∏–∫–∞–º–∏
                lastClickTime = now;
                
                this.classList.add('click-animation');
                setTimeout(() => {
                    this.classList.remove('click-animation');
                }, 200);
                
                // –ú–µ–Ω—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –∫–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è
                const currentCostume = costumes[selectedCostume];
                aliceImg.src = currentCostume ? currentCostume.tapImage : 'AliceTap.png';
                
                setTimeout(() => {
                    aliceImg.src = currentCostume ? currentCostume.mainImage : 'Alice.png';
                }, 200);
                
                clickCount++;
                questClicks.clicksForQuests++; // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤ –¥–ª—è –∫–≤–µ—Å—Ç–æ–≤
                localStorage.setItem('aliceClickCount', clickCount.toString());
                localStorage.setItem('aliceQuestClicks', JSON.stringify(questClicks));
                clickCounter.textContent = clickCount;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏—Å—å –ª–∏ –Ω–æ–≤—ã–µ –∫–æ—Å—Ç—é–º—ã
                checkUnlockedCostumes();
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–≤–µ—Å—Ç—ã
                checkQuestsCompletion();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–ª—è —É–ª—ã–±–∫–∏
                if (!actionsCompleted.smile) {
                    actionsProgress.smile = Math.min(100, clickCount * 10); // 10 –∫–ª–∏–∫–æ–≤ = 100%
                    updateActionsProgress();
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ "—É–ª—ã–±–∫–∞"
                if (clickCount >= 10 && !actionsCompleted.smile) {
                    actionsCompleted.smile = true;
                    localStorage.setItem('aliceActionsCompleted', JSON.stringify(actionsCompleted));
                    smileBtn.classList.add('completed');
                    // –î–∞–µ–º –º–µ–Ω—å—à–µ XP –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ –≤—ã—Å–æ–∫–∏—Ö —É—Ä–æ–≤–Ω—è—Ö
                    const xpReward = Math.max(5, 25 - Math.floor(level / 2));
                    addXP(xpReward);
                    checkActionsCompletion();
                }
            });
        }
        
        function checkUnlockedCostumes() {
            let updated = false;
            
            for (const [key, costume] of Object.entries(costumes)) {
                if (!unlockedCostumes[key] && 
                    clickCount >= costume.clicksRequired && 
                    level >= costume.levelRequired) {
                    unlockedCostumes[key] = true;
                    updated = true;
                }
            }
            
            if (updated) {
                localStorage.setItem('aliceUnlockedCostumes', JSON.stringify(unlockedCostumes));
                if (costumesModal.classList.contains('active')) {
                    showCostumes();
                }
            }
        }
        
        function startSleepTimer() {
            if (isSleeping) return;
            
            isSleeping = true;
            sleepTimeLeft = 60; // –í—Ä–µ–º—è —Å–µ–∫—É–Ω–¥—ã –≤ –º–∏–Ω—É—Ç—ã
            sleepStartTime = Date.now();
            lastUpdateTime = Date.now();
            accumulatedSleepTime = 0;
            updateSleepTimerDisplay();
            sleepTimer.style.display = 'block';
            
            sleepInterval = setInterval(updateSleepTime, 1000);
        }
        
        function updateSleepTime() {
            const now = Date.now();
            const deltaTime = now - lastUpdateTime;
            lastUpdateTime = now;
            
            if (!isLightOn) { // –¢–∞–π–º–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —Å–≤–µ—Ç –≤—ã–∫–ª—é—á–µ–Ω
                accumulatedSleepTime += deltaTime;
                const timePassed = Math.floor(accumulatedSleepTime / 1000);
                sleepTimeLeft = Math.max(0, 60 - timePassed);
                updateSleepTimerDisplay();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–ª—è —Å–Ω–∞
                if (!actionsCompleted.sleep) {
                    actionsProgress.sleep = Math.min(100, (60 - sleepTimeLeft) / 60 * 100);
                    updateActionsProgress();
                }
                
                if (sleepTimeLeft <= 0) {
                    clearInterval(sleepInterval);
                    isSleeping = false;
                    
                    // –ü–æ–º–µ—á–∞–µ–º –¥–µ–π—Å—Ç–≤–∏–µ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ
                    if (!actionsCompleted.sleep) {
                        actionsCompleted.sleep = true;
                        localStorage.setItem('aliceActionsCompleted', JSON.stringify(actionsCompleted));
                        sleepBtn.classList.add('completed');
                        // –î–∞–µ–º –º–µ–Ω—å—à–µ XP –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ –≤—ã—Å–æ–∫–∏—Ö —É—Ä–æ–≤–Ω—è—Ö
                        const xpReward = Math.max(5, 25 - Math.floor(level / 2));
                        addXP(xpReward);
                        checkActionsCompletion();
                    }
                    
                    sleepTimer.style.display = 'none';
                }
            }
        }
        
        function updateSleepTimerDisplay() {
            const minutes = Math.floor(sleepTimeLeft / 60);
            const seconds = sleepTimeLeft % 60;
            sleepTimer.textContent = `${minutes}:${seconds < 10 ? '0' + seconds : seconds}`;
        }
        
        function spawnFood() {
            if (isFoodSpawning) return;
            isFoodSpawning = true;
            
            foodItems.innerHTML = '';
            foodItemsEaten = 0;
            
            foodTypes.forEach(food => {
                const foodItem = document.createElement('div');
                foodItem.className = 'food-item';
                foodItem.dataset.food = food;
                foodItem.textContent = food;
                foodItems.appendChild(foodItem);
            });
            
            setupFoodInteraction();
            isFoodSpawning = false;
        }
        
        function setupFoodInteraction() {
            document.querySelectorAll('.food-item').forEach(food => {
                food.addEventListener('mousedown', startDrag);
                food.addEventListener('touchstart', startDrag, { passive: false });
            });
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', drag, { passive: false });
            document.addEventListener('mouseup', endDrag);
            document.addEventListener('touchend', endDrag);
        }
        
        function startDrag(e) {
            e.preventDefault();
            activeFoodItem = e.target.closest('.food-item');
            if (!activeFoodItem) return;
            
            const rect = activeFoodItem.getBoundingClientRect();
            
            if (e.type === 'mousedown') {
                startX = e.clientX;
                startY = e.clientY;
            } else if (e.type === 'touchstart') {
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
            }
            
            offsetX = startX - rect.left;
            offsetY = startY - rect.top;
            
            activeFoodItem.classList.add('dragging');
            activeFoodItem.style.position = 'fixed';
            activeFoodItem.style.left = `${rect.left}px`;
            activeFoodItem.style.top = `${rect.top}px`;
        }
        
        function drag(e) {
            if (!activeFoodItem) return;
            e.preventDefault();
            
            let clientX, clientY;
            if (e.type === 'mousemove') {
                clientX = e.clientX;
                clientY = e.clientY;
            } else if (e.type === 'touchmove') {
                clientX = e.touches[0].clientX;
                clientY = e.touches[0].clientY;
            }
            
            activeFoodItem.style.left = `${clientX - offsetX}px`;
            activeFoodItem.style.top = `${clientY - offsetY}px`;
        }
        
        function endDrag(e) {
            if (!activeFoodItem) return;
            
            const aliceRect = foodAliceContainer.getBoundingClientRect();
            const foodRect = activeFoodItem.getBoundingClientRect();
            
            if (checkCollision(foodRect, aliceRect)) {
                activeFoodItem.classList.add('eating');
                setTimeout(() => {
                    foodItemsEaten++;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–ª—è –µ–¥—ã
                    if (!actionsCompleted.food) {
                        actionsProgress.food = Math.min(100, foodItemsEaten / 3 * 100);
                        updateActionsProgress();
                    }
                    
                    if (foodItemsEaten >= 3 && !actionsCompleted.food) {
                        actionsCompleted.food = true;
                        localStorage.setItem('aliceActionsCompleted', JSON.stringify(actionsCompleted));
                        foodBtn.classList.add('completed');
                        // –î–∞–µ–º –º–µ–Ω—å—à–µ XP –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ –≤—ã—Å–æ–∫–∏—Ö —É—Ä–æ–≤–Ω—è—Ö
                        const xpReward = Math.max(5, 25 - Math.floor(level / 2));
                        addXP(xpReward);
                        checkActionsCompletion();
                    }
                    
                    if (foodItemsEaten >= 3) {
                        setTimeout(spawnFood, 500);
                    }
                }, 300);
            } else {
                activeFoodItem.classList.remove('dragging');
                activeFoodItem.style.position = '';
                activeFoodItem.style.left = '';
                activeFoodItem.style.top = '';
            }
            
            activeFoodItem = null;
        }
        
        function checkCollision(rect1, rect2) {
            return !(
                rect1.right < rect2.left || 
                rect1.left > rect2.right || 
                rect1.bottom < rect2.top || 
                rect1.top > rect2.bottom
            );
        }
        
        function createToiletDoor() {
            const toiletRoom = document.getElementById('toiletBg');
            
            // –°–æ–∑–¥–∞–µ–º –¥–≤–µ—Ä—å
            toiletDoor = document.createElement('div');
            toiletDoor.className = 'toilet-door';
            toiletRoom.appendChild(toiletDoor);
            
            setupDoorInteraction();
        }

        function setupDoorInteraction() {
            let startX = 0;
            let isDragging = false;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º—ã—à–∏
            toiletDoor.addEventListener('mousedown', function(e) {
                isDragging = true;
                startX = e.clientX;
                e.preventDefault();
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è touch-—É—Å—Ç—Ä–æ–π—Å—Ç–≤
            toiletDoor.addEventListener('touchstart', function(e) {
                isDragging = true;
                startX = e.touches[0].clientX;
                e.preventDefault();
            }, { passive: false });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–≤–∏–∂–µ–Ω–∏—è –¥–ª—è –º—ã—à–∏
            document.addEventListener('mousemove', function(e) {
                if (!isDragging || !toiletDoor) return;
                
                const moveX = e.clientX - startX;
                const newPosition = Math.min(0, Math.max(-15, moveX / 10));
                
                if (toiletUsed) {
                    openDoor();
                    return;
                }
                
                toiletDoor.style.transform = `translateX(${newPosition}vh) translateY(-50%)`;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–ª—è —Ç—É–∞–ª–µ—Ç–∞
                if (!actionsCompleted.toilet) {
                    actionsProgress.toilet = Math.min(100, Math.abs(newPosition) / 15 * 100);
                    updateActionsProgress();
                }
                
                if (newPosition <= -12 && !isDoorMoving) {
                    closeDoor();
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–≤–∏–∂–µ–Ω–∏—è –¥–ª—è touch-—É—Å—Ç—Ä–æ–π—Å—Ç–≤
            document.addEventListener('touchmove', function(e) {
                if (!isDragging || !toiletDoor) return;
                
                const moveX = e.touches[0].clientX - startX;
                const newPosition = Math.min(0, Math.max(-15, moveX / 10));
                
                if (toiletUsed) {
                    openDoor();
                    return;
                }
                
                toiletDoor.style.transform = `translateX(${newPosition}vh) translateY(-50%)`;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–ª—è —Ç—É–∞–ª–µ—Ç–∞
                if (!actionsCompleted.toilet) {
                    actionsProgress.toilet = Math.min(100, Math.abs(newPosition) / 15 * 100);
                    updateActionsProgress();
                }
                
                if (newPosition <= -12 && !isDoorMoving) {
                    closeDoor();
                }
                
                e.preventDefault();
            }, { passive: false });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—É—Å–∫–∞–Ω–∏—è –¥–ª—è –º—ã—à–∏
            document.addEventListener('mouseup', function() {
                if (!isDragging) return;
                isDragging = false;
                
                if (!isDoorMoving && !toiletUsed) {
                    toiletDoor.style.transform = 'translateX(0) translateY(-50%)';
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—É—Å–∫–∞–Ω–∏—è –¥–ª—è touch-—É—Å—Ç—Ä–æ–π—Å—Ç–≤
            document.addEventListener('touchend', function() {
                if (!isDragging) return;
                isDragging = false;
                
                if (!isDoorMoving && !toiletUsed) {
                    toiletDoor.style.transform = 'translateX(0) translateY(-50%)';
                }
            });
        }

        function closeDoor() {
            if (isDoorMoving) return;
            
            isDoorMoving = true;
            toiletDoor.style.transform = 'translateX(-15vh) translateY(-50%)';
            
            doorTimeout = setTimeout(() => {
                openDoor();
                toiletUsed = true;
                
                // –ü–æ–º–µ—á–∞–µ–º –¥–µ–π—Å—Ç–≤–∏–µ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ
                if (!actionsCompleted.toilet) {
                    actionsCompleted.toilet = true;
                    localStorage.setItem('aliceActionsCompleted', JSON.stringify(actionsCompleted));
                    toiletBtn.classList.add('completed');
                    // –î–∞–µ–º –º–µ–Ω—å—à–µ XP –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ –≤—ã—Å–æ–∫–∏—Ö —É—Ä–æ–≤–Ω—è—Ö
                    const xpReward = Math.max(5, 25 - Math.floor(level / 2));
                    addXP(xpReward);
                    checkActionsCompletion();
                }
            }, 5000);
        }

        function openDoor() {
            isDoorMoving = false;
            toiletDoor.style.transform = 'translateX(0) translateY(-50%)';
            if (doorTimeout) {
                clearTimeout(doorTimeout);
                doorTimeout = null;
            }
        }
        
        function changeRoom(roomId) {
            document.querySelectorAll('.room').forEach(room => {
                room.style.display = 'none';
            });
            document.getElementById(roomId).style.display = 'block';
            
            if (roomId === 'sleepBg') {
                lightSwitch.style.display = 'flex';
                darkOverlay.style.display = isLightOn ? 'none' : 'block';
                sleepTimer.style.display = isLightOn ? 'none' : 'block';
                
                if (!isLightOn && !actionsCompleted.sleep && !isSleeping) {
                    startSleepTimer();
                }
            } else {
                lightSwitch.style.display = 'none';
                sleepTimer.style.display = 'none';
            }
            
            if (roomId === 'foodBg') {
                if (foodItems.children.length === 0) {
                    spawnFood();
                }
            }
            
            if (roomId === 'toiletBg') {
                if (!toiletDoor) {
                    createToiletDoor();
                } else {
                    openDoor();
                }
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫–∏ —Ç–æ–ª—å–∫–æ –≤ –≥–ª–∞–≤–Ω–æ–π –∫–æ–º–Ω–∞—Ç–µ
            if (roomId === 'smileBg') {
                clickCounter.style.display = 'flex';
                crystalCounter.style.display = 'flex';
            } else {
                clickCounter.style.display = 'none';
                crystalCounter.style.display = 'none';
            }
        }
        
        function toggleLight() {
            isLightOn = !isLightOn;
            darkOverlay.style.display = isLightOn ? 'none' : 'block';
            sleepTimer.style.display = isLightOn ? 'none' : 'block';
            
            if (!isLightOn && !actionsCompleted.sleep && !isSleeping) {
                startSleepTimer();
            }
        }
        
        function checkActionsCompletion() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—Å–µ –ª–∏ –¥–µ–π—Å—Ç–≤–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
            if (actionsCompleted.smile && actionsCompleted.food && 
                actionsCompleted.toilet && actionsCompleted.sleep) {
                
                // –ù–∞—á–∏—Å–ª—è–µ–º –∫—Ä–∏—Å—Ç–∞–ª–ª—ã –∏ —Ç–æ–∫–µ–Ω—ã –∑–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π –¥–µ–Ω—å
                crystals += 1;
                tokens += 50;
                localStorage.setItem('aliceCrystals', crystals.toString());
                localStorage.setItem(`aliceTokens_season_${passConfig.Season}`, tokens.toString());
                updateCounters();
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è –Ω–æ–≤–æ–≥–æ –¥–Ω—è
                resetDailyActions();
            }
        }
        
        function resetDailyActions() {
            actionsCompleted = {
                smile: false,
                food: false,
                toilet: false,
                sleep: false
            };
            
            actionsProgress = {
                smile: 0,
                food: 0,
                toilet: 0,
                sleep: 0
            };
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤ –¥–ª—è –∫–≤–µ—Å—Ç–æ–≤ –ø—Ä–∏ –Ω–æ–≤–æ–º –¥–Ω–µ
            questClicks.clicksForQuests = 0;
            questClicks.lastResetTime = Date.now();
            localStorage.setItem('aliceQuestClicks', JSON.stringify(questClicks));
            
            localStorage.setItem('aliceActionsCompleted', JSON.stringify(actionsCompleted));
            localStorage.setItem('aliceActionsProgress', JSON.stringify(actionsProgress));
            updateButtonsState();
            updateActionsProgress();
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–º–Ω–∞—Ç
            toiletUsed = false;
            if (toiletDoor) {
                openDoor();
            }
            
            // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –µ–¥—É
            if (document.getElementById('foodBg').style.display === 'block') {
                spawnFood();
            }
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–∞–π–º–µ—Ä —Å–Ω–∞
            if (sleepInterval) {
                clearInterval(sleepInterval);
                sleepInterval = null;
            }
            isSleeping = false;
            sleepTimer.style.display = 'none';
        }
        
        function showSettingsModal() {
            settingsModal.classList.add('active');
        }
        
        function hideSettingsModal() {
            settingsModal.classList.remove('active');
        }
        
        function showCostumesModal() {
            costumesModal.classList.add('active');
            showCostumes();
        }
        
        function hideCostumesModal() {
            costumesModal.classList.remove('active');
        }
        
        function showShopModal() {
            shopModal.classList.add('active');
            promoCodeInput.value = "";
            promoResult.textContent = "";
            promoResult.className = "promo-result";
            showStocks();
        }
        
        function hideShopModal() {
            shopModal.classList.remove('active');
        }
        
        function showStocks() {
            shopContainer.innerHTML = '';
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ü–∏–∏ –≤ –º–∞–≥–∞–∑–∏–Ω
            for (const [key, stock] of Object.entries(stocks)) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∏ –Ω–µ–∫—É–ø–ª–µ–Ω–Ω—ã–µ –∞–∫—Ü–∏–∏
                if (!purchasedStocks[key] && clickCount >= stock.requirements.clicks && level >= stock.requirements.level) {
                    const stockItem = document.createElement('div');
                    stockItem.className = 'shop-item';
                    
                    stockItem.innerHTML = `
                        <img src="${stock.title}" class="shop-image" alt="${stock.name}">
                    `;
                    
                    stockItem.addEventListener('click', () => purchaseStock(key));
                    shopContainer.appendChild(stockItem);
                }
            }
            
            // –ï—Å–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–∫—Ü–∏–π
            if (shopContainer.children.length === 0) {
                shopContainer.innerHTML = '<div style="text-align: center; padding: 2vh;">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–∫—Ü–∏–π</div>';
            }
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å–∫—Ä–æ–ª–ª
            setupShopScroll();
        }
        
        function purchaseStock(stockKey) {
            const stock = stocks[stockKey];
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –ø–æ–∫—É–ø–∫–∏
            if (stock.price.type !== "free") {
                if (stock.price.type === "clicks" && clickCount < stock.price.value) {
                    showRewardNotification("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫–ª–∏–∫–æ–≤!");
                    return;
                }
                
                if (stock.price.type === "crystals" && crystals < stock.price.value) {
                    showRewardNotification("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤!");
                    return;
                }
            }
            
            // –°–ø–∏—Å—ã–≤–∞–µ–º —Å—Ä–µ–¥—Å—Ç–≤–∞
            if (stock.price.type === "clicks") {
                clickCount -= stock.price.value;
                localStorage.setItem('aliceClickCount', clickCount.toString());
            } else if (stock.price.type === "crystals") {
                crystals -= stock.price.value;
                localStorage.setItem('aliceCrystals', crystals.toString());
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ü–∏—é –≤ —Å–ø–∏—Å–æ–∫ –∫—É–ø–ª–µ–Ω–Ω—ã—Ö
            purchasedStocks[stockKey] = true;
            localStorage.setItem('alicePurchasedStocks', JSON.stringify(purchasedStocks));
            
            // –£–±–∏—Ä–∞–µ–º –º–µ—Ç–∫—É "–ù–û–í–û–ï!"
            if (newStocks[stockKey]) {
                delete newStocks[stockKey];
                localStorage.setItem('aliceNewStocks', JSON.stringify(newStocks));
            }
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º –±–æ–Ω—É—Å—ã –∏–∑ –∞–∫—Ü–∏–∏
            let message = "–ü–æ–ª—É—á–µ–Ω–æ: ";
            const bonuses = [];
            
            if (Array.isArray(stock.value)) {
                // –ï—Å–ª–∏ –∞–∫—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–æ–Ω—É—Å–æ–≤
                stock.value.forEach(item => {
                    if (typeof item === "string") {
                        // –ö–æ—Å—Ç—é–º
                        unlockedCostumes[item] = true;
                        localStorage.setItem('aliceUnlockedCostumes', JSON.stringify(unlockedCostumes));
                        bonuses.push(`–∫–æ—Å—Ç—é–º "${costumes[item].name}"`);
                    } else {
                        // –ö–ª–∏–∫–∏
                        clickCount += item;
                        localStorage.setItem('aliceClickCount', clickCount.toString());
                        bonuses.push(`${item} –∫–ª–∏–∫–æ–≤`);
                    }
                });
            } else if (stock.type === "pass") {
                // –ü—Ä–µ–º–∏—É–º –ø–∞—Å—Å
                hasPremiumPass = true;
                localStorage.setItem(`aliceHasPremiumPass_season_${passConfig.Season}`, 'true');
                bonuses.push("Premium Pass");
            } else if (stock.type === "clicks") {
                // –ö–ª–∏–∫–∏
                clickCount += stock.value;
                localStorage.setItem('aliceClickCount', clickCount.toString());
                bonuses.push(`${stock.value} –∫–ª–∏–∫–æ–≤`);
            } else if (stock.type === "crystals") {
                // –ö—Ä–∏—Å—Ç–∞–ª–ª—ã
                crystals += stock.value;
                localStorage.setItem('aliceCrystals', crystals.toString());
                bonuses.push(`${stock.value} –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤`);
            }
            
            message += bonuses.join(" –∏ ");
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫–∏
            updateCounters();
            checkUnlockedCostumes();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∫—É–ø–∫–∏
            showRewardNotification(message);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–∞–≥–∞–∑–∏–Ω
            showStocks();
        }
        
        function setupShopScroll() {
            const container = shopContainer;
            const scrollbar = document.getElementById('shopScrollbarThumb');
            
            function updateScrollbar() {
                const scrollRatio = container.scrollLeft / (container.scrollWidth - container.clientWidth);
                const thumbPosition = scrollRatio * (container.clientWidth - scrollbar.clientWidth);
                scrollbar.style.left = `${thumbPosition}px`;
            }
            
            container.addEventListener('scroll', updateScrollbar);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è —Å–∫—Ä–æ–ª–ª–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–∏ –ø–æ–ª–∑—É–Ω–∫–∞
            let isDragging = false;
            let startX;
            
            scrollbar.addEventListener('mousedown', function(e) {
                isDragging = true;
                startX = e.clientX;
                e.preventDefault();
            });
            
            scrollbar.addEventListener('touchstart', function(e) {
                isDragging = true;
                startX = e.touches[0].clientX;
                e.preventDefault();
            }, { passive: false });
            
            document.addEventListener('mousemove', function(e) {
                if (!isDragging) return;
                
                const deltaX = e.clientX - startX;
                const containerWidth = container.clientWidth;
                const scrollWidth = container.scrollWidth;
                
                const scrollRatio = deltaX / containerWidth;
                container.scrollLeft = scrollRatio * (scrollWidth - container.clientWidth);
                
                startX = e.clientX;
            });
            
            document.addEventListener('touchmove', function(e) {
                if (!isDragging) return;
                
                const deltaX = e.touches[0].clientX - startX;
                const containerWidth = container.clientWidth;
                const scrollWidth = container.scrollWidth;
                
                const scrollRatio = deltaX / containerWidth;
                container.scrollLeft = scrollRatio * (scrollWidth - container.clientWidth);
                
                startX = e.touches[0].clientX;
                e.preventDefault();
            }, { passive: false });
            
            document.addEventListener('mouseup', function() {
                isDragging = false;
            });
            
            document.addEventListener('touchend', function() {
                isDragging = false;
            });
            
            updateScrollbar();
        }
        
        function showCostumes() {
            costumesContainer.innerHTML = '';
            
            // –°–æ–∑–¥–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é "–î–æ—Å—Ç—É–ø–Ω—ã–µ"
            const availableCategory = document.createElement('div');
            availableCategory.className = 'costume-category';
            availableCategory.innerHTML = '<div class="costume-category-title">–î–æ—Å—Ç—É–ø–Ω—ã–µ</div><div class="costume-grid" id="availableCostumes"></div>';
            costumesContainer.appendChild(availableCategory);
            
            const availableGrid = document.getElementById('availableCostumes');
            
            // –°–æ–∑–¥–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ"
            const lockedCategory = document.createElement('div');
            lockedCategory.className = 'costume-category';
            lockedCategory.innerHTML = '<div class="costume-category-title">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ</div><div class="costume-grid" id="lockedCostumes"></div>';
            costumesContainer.appendChild(lockedCategory);
            
            const lockedGrid = document.getElementById('lockedCostumes');
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–æ—Å—Ç—é–º—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            for (const [key, costume] of Object.entries(costumes)) {
                const costumeItem = document.createElement('div');
                costumeItem.className = `costume-item ${unlockedCostumes[key] ? '' : 'locked'}`;
                if (selectedCostume === key) {
                    costumeItem.classList.add('selected-costume');
                }
                
                costumeItem.innerHTML = `
                    <img src="${costume.titleImage}" class="costume-image" alt="${costume.name}">
                    <div class="costume-name">${costume.name}</div>
                    <div class="costume-info">${costume.infoText}</div>
                    <div class="costume-price ${unlockedCostumes[key] ? '' : 'locked'}">
                        ${unlockedCostumes[key] ? '–î–æ—Å—Ç—É–ø–µ–Ω' : costume.priceText}
                    </div>
                `;
                
                if (unlockedCostumes[key]) {
                    costumeItem.addEventListener('click', () => selectCostume(key));
                    availableGrid.appendChild(costumeItem);
                } else {
                    lockedGrid.appendChild(costumeItem);
                }
            }
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å–∫—Ä–æ–ª–ª
            setupCostumesScroll();
        }
        
        function selectCostume(costumeKey) {
            selectedCostume = costumeKey;
            localStorage.setItem('aliceSelectedCostume', selectedCostume);
            loadSelectedCostume();
            showCostumes(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∫–æ—Å—Ç—é–º–æ–≤, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å –Ω–æ–≤—ã–π –≤—ã–±—Ä–∞–Ω–Ω—ã–π
        }
        
        function setupCostumesScroll() {
            const container = costumesContainer;
            const scrollbar = document.getElementById('scrollbarThumb');
            
            function updateScrollbar() {
                const scrollRatio = container.scrollTop / (container.scrollHeight - container.clientHeight);
                const thumbPosition = scrollRatio * (container.clientWidth - scrollbar.clientWidth);
                scrollbar.style.left = `${thumbPosition}px`;
            }
            
            container.addEventListener('scroll', updateScrollbar);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è —Å–∫—Ä–æ–ª–ª–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –ø–æ–ª–∑—É–Ω–∫–∞
            let isDragging = false;
            let startX;
            
            scrollbar.addEventListener('mousedown', function(e) {
                isDragging = true;
                startX = e.clientX;
                e.preventDefault();
            });
            
            scrollbar.addEventListener('touchstart', function(e) {
                isDragging = true;
                startX = e.touches[0].clientX;
                e.preventDefault();
            }, { passive: false });
            
            document.addEventListener('mousemove', function(e) {
                if (!isDragging) return;
                
                const deltaX = e.clientX - startX;
                const containerWidth = container.clientWidth;
                const scrollWidth = container.scrollWidth;
                
                const scrollRatio = deltaX / containerWidth;
                container.scrollTop = scrollRatio * (scrollWidth - container.clientWidth);
                
                startX = e.clientX;
            });
            
            document.addEventListener('touchmove', function(e) {
                if (!isDragging) return;
                
                const deltaX = e.touches[0].clientX - startX;
                const containerWidth = container.clientWidth;
                const scrollWidth = container.scrollWidth;
                
                const scrollRatio = deltaX / containerWidth;
                container.scrollTop = scrollRatio * (scrollWidth - container.clientWidth);
                
                startX = e.touches[0].clientX;
                e.preventDefault();
            }, { passive: false });
            
            document.addEventListener('mouseup', function() {
                isDragging = false;
            });
            
            document.addEventListener('touchend', function() {
                isDragging = false;
            });
            
            updateScrollbar();
        }
        
        function showManualModal() {
            manualModal.classList.add('active');
            manualPage = 1;
            updateManualPage();
        }
        
        function hideManualModal() {
            manualModal.classList.remove('active');
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            initAlice();
            lightSwitch.addEventListener('click', toggleLight);
            
            howToPlayBtn.addEventListener('click', showManualModal);
            backFromSettingsBtn.addEventListener('click', hideSettingsModal);
            backFromCostumesBtn.addEventListener('click', hideCostumesModal);
            backFromShopBtn.addEventListener('click', hideShopModal);
            backFromPassBtn.addEventListener('click', hidePassModal);
            backFromManualBtn.addEventListener('click', hideManualModal);
        });
    </script>
</body>
</html>